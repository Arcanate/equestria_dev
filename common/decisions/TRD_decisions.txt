TRD_vaults = {
	TRD_money_guichard = {
		icon = steel
		available = {
			always = no
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision TRD_money_guichard"
		}
	}
	TRD_money_mission = {
		icon = steel
		available = {
			check_variable = { trade_partners^num < 1 }
		}
		activation = {
			check_variable = { trade_partners^num > 0 }
		}
		is_good = yes
		days_mission_timeout = 120 #4 months, change if you need to later
		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision timeout TRD_money_mission"
			hidden_effect = {
				# first we wanna remove countries we are no longer trading with
				# we use two arrays because removing stuff from an array you are iterating over is a BAD IDEA
				for_each_scope_loop = {
					array = trade_partners
					if = {
						limit = {
							OR = {
								exists = no
								AND = {
									NOT = { has_idea = TRD_trading_with_skyfall_1 }
									NOT = { has_idea = TRD_trading_with_skyfall_2 }
								}
							}
						}
						add_to_temp_array = { ROOT.trade_partners_to_remove = THIS }
					}
				}
				for_each_scope_loop = {
					array = trade_partners_to_remove
					remove_from_array = { ROOT.trade_partners_to_remove = THIS }
				}
				set_temp_variable = { add_to_bank = trade_partners^num }
				multiply_temp_variable = { add_to_bank = 0.25 }
			}

			# Cyrus baby, localise it plz <3
			custom_effect_tooltip = TRD_GAIN_BANK
			add_to_variable = {
				var = bank
				value = add_to_bank
			}

			hidden_effect = {
				activate_mission = TRD_money_mission
			}
		}
	}

}

political_actions = {
	TRD_trade_with_skyfall = {
		icon = ger_mefo_bills
		available = {
			NOT = { has_war_with = TRD }
			any_owned_state = {
				is_coastal = yes
				is_fully_controlled_by = ROOT
			}
		}
		allowed = {
			NOT = {
				original_tag = FLO
				original_tag = KAT
				original_tag = TRD
				original_tag = FBK
				original_tag = WAT
				original_tag = FIR
				original_tag = NIM
				original_tag = BAK
				original_tag = DEP
				original_tag = LCT
				original_tag = RCT
				original_tag = DMT
				original_tag = FBK
				original_tag = FRE
				original_tag = WIT
				original_tag = BAR
			}
		}
		visible = {
			NOT = {
				has_government = communism
				has_idea = detached_country
				has_idea = communal_society
				has_idea = agrarian_society
				has_tribal_society = yes
				has_idea = TRD_trading_with_skyfall_1
				has_idea = TRD_trading_with_skyfall_2
			}
			FROM = {
				exists = yes
				NOT = {
					has_government = communism
					has_war_with = ROOT
				}
			}
		}

		target_trigger = {
			FROM = { tag = TRD }
		}
		
		cost = 75
		days_re_enable = 180
		
		ai_will_do = {
			factor = 10
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision TRD_trade_with_skyfall"
			FROM = {
				country_event = tradefed.7
			}
		}
	}
	
	TRD_stop_trading_with_skyfall = {
		icon = ger_mefo_bills
		available = {
		
		}
		visible = {
		    OR = {
				has_idea = TRD_trading_with_skyfall_1
				has_idea = TRD_trading_with_skyfall_2
			}
		}

		target_trigger = {
			FROM = { tag = TRD }
		}
		
		cost = 25
		days_re_enable = 180
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 1.5
				has_opinion = { target = TRD value < -75 }
			}
			modifier = {
				factor = 1.5
				has_opinion = { target = TRD value < -50 }
			}
			modifier = {
				factor = 1.5
				has_opinion = { target = TRD value < -25 }
			}
			modifier = {
				factor = 1.5
				has_opinion = { target = TRD value < 0 }
			}
			modifier = {
				factor = 1.5
				has_opinion = { target = TRD value < 25 }
			}
		}
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision TRD_stop_trading_with_skyfall"
			if = { 
		    	limit = { has_idea = TRD_trading_with_skyfall_2 }
		    	remove_ideas = TRD_trading_with_skyfall_2
		    }
		    if = { 
		    	limit = { has_idea = TRD_trading_with_skyfall_1 }
		    	remove_ideas = TRD_trading_with_skyfall_1
		    }
			FROM = {
				country_event = tradefed.10
			}
			hidden_effect = {
				remove_from_array = {
					TRD.trade_partners = ROOT
				}
			}
		}
	}
}