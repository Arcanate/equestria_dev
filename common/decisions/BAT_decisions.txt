BAT_appoint_warmaster = {
    BAT_appoint_autumn = {
		ai_will_do = {
			factor = 100
		}
		available = {
		    NOT = {
			    has_country_flag = BAT_changed_leader_flag
			}
		}
		visible = {
            OR = {
			    has_government = neutrality
				has_government = fascism
			}
			NOT = {
			    has_country_leader = { 
		            ruling_only = yes 
			        name = "Autumn Breeze" 
		        }
			}
		}
        icon = lunar_war_plan
		
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision BAT_appoint_autumn"
			custom_effect_tooltip = BAT_changed_leader_tp
			create_country_leader = {
	            name = "Autumn Breeze"
	            desc = BAT_AUTUMN_BREEZE_DESC
	            expire = "1965.1.1"
	            picture = "BAT_Autumn_Breeze.tga"
	            ideology = nazism
	            traits = {
	                BAT_political_savant
	            }
            }
			create_country_leader = {
	            name = "Autumn Breeze"
	            desc = BAT_AUTUMN_BREEZE_DESC
	            expire = "1965.1.1"
	            picture = "BAT_Autumn_Breeze.tga"
	            ideology = despotism
	            traits = {
	                BAT_political_savant
	            }
            }
			hidden_effect = { 
			    set_country_flag = { 
				    flag = BAT_changed_leader_flag 
					days = 365 
					value = 1 
				} 
			}
		}
	}
	
	BAT_appoint_emerald = {
		ai_will_do = {
			factor = 100
		}
		available = {
		    NOT = {
			    has_country_flag = BAT_changed_leader_flag
			}
		}
		visible = {
            OR = {
			    has_government = neutrality
				has_government = fascism
			}
			NOT = {
			    has_country_leader = { 
		            ruling_only = yes 
			        name = "Emerald Light" 
		        }
			}
		}
        icon = lunar_war_plan
		
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision BAT_appoint_emerald"
			custom_effect_tooltip = BAT_changed_leader_tp
			create_country_leader = {
	            name = "Emerald Light"
	            desc = BAT_EMERALD_LIGHT_DESC
	            expire = "1965.1.1"
	            picture = "BAT_Autumn_Breeze.tga"
	            ideology = nazism
	            traits = {
	                BAT_enthusiastic_researcher
	            }
            }
			create_country_leader = {
	            name = "Emerald Light"
	            desc = BAT_EMERALD_LIGHT_DESC
	            expire = "1965.1.1"
	            picture = "BAT_Autumn_Breeze.tga"
	            ideology = despotism
	            traits = {
	                BAT_enthusiastic_researcher
	            }
            }
			hidden_effect = { 
			    set_country_flag = { 
				    flag = BAT_changed_leader_flag 
					days = 365 
					value = 1 
				} 
			}
		}
	}
	
	BAT_appoint_eclipse = {
		ai_will_do = {
			factor = 100
		}
		available = {
		    NOT = {
			    has_country_flag = BAT_changed_leader_flag
			}
		}
		visible = {
            OR = {
			    has_government = neutrality
				has_government = fascism
			}
			NOT = {
			    has_country_leader = { 
		            ruling_only = yes 
			        name = "Eternal Eclipse" 
		        }
			}
		}
        icon = lunar_war_plan
		
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision BAT_appoint_eclipse"
			custom_effect_tooltip = BAT_changed_leader_tp
			create_country_leader = {
	            name = "Eternal Eclipse"
	            desc = BAT_ETERNAL_ECLIPSE_DESC
	            expire = "1965.1.1"
	            picture = "BAT_Autumn_Breeze.tga"
	            ideology = nazism
	            traits = {
	                BAT_affable_slavemaster
	            }
            }
			create_country_leader = {
	            name = "Eternal Eclipse"
	            desc = BAT_ETERNAL_ECLIPSE_DESC
	            expire = "1965.1.1"
	            picture = "BAT_Autumn_Breeze.tga"
	            ideology = despotism
	            traits = {
	                BAT_affable_slavemaster
	            }
            }
			hidden_effect = { 
			    set_country_flag = { 
				    flag = BAT_changed_leader_flag 
					days = 365 
					value = 1 
				} 
			}
		}
	}
	
	BAT_appoint_hail = {
		ai_will_do = {
			factor = 100
		}
		available = {
		    NOT = {
			    has_country_flag = BAT_changed_leader_flag
			}
		}
		visible = {
            OR = {
			    has_government = neutrality
				has_government = fascism
			}
			NOT = {
			    has_country_leader = { 
		            ruling_only = yes 
			        name = "Lunar Hail" 
		        }
			}
		}
        icon = lunar_war_plan
		
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision BAT_appoint_hail"
			custom_effect_tooltip = BAT_changed_leader_tp
			create_country_leader = {
	            name = "Lunar Hail"
	            desc = BAT_LUNAR_HAIL_DESC
	            expire = "1965.1.1"
	            picture = "BAT_Autumn_Breeze.tga"
	            ideology = nazism
	            traits = {
	                BAT_frothing_fanatic
	            }
            }
			create_country_leader = {
	            name = "Lunar Hail"
	            desc = BAT_LUNAR_HAIL_DESC
	            expire = "1965.1.1"
	            picture = "BAT_Autumn_Breeze.tga"
	            ideology = despotism
	            traits = {
	                BAT_frothing_fanatic
	            }
            }
			hidden_effect = { 
			    set_country_flag = { 
				    flag = BAT_changed_leader_flag 
					days = 365 
					value = 1 
				} 
			}
		}
	}
	
    BAT_appoint_lightning = {
		ai_will_do = {
			factor = 100
		}
		available = {
		    NOT = {
			    has_country_flag = BAT_changed_leader_flag
			}
		}
		visible = {
            OR = {
			    has_government = neutrality
				has_government = fascism
			}
			NOT = {
			    has_country_leader = { 
		            ruling_only = yes 
			        name = "Lightning Charm" 
		        }
			}
		}
        icon = lunar_war_plan
		
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision BAT_appoint_lightning"
			custom_effect_tooltip = BAT_changed_leader_tp
			create_country_leader = {
	            name = "Lightning Charm"
	            desc = BAT_LIGHTNING_CHARM_DESC
	            expire = "1965.1.1"
	            picture = "BAT_Autumn_Breeze.tga"
	            ideology = nazism
	            traits = {
	                BAT_dedicated_soldier
	            }
            }
			create_country_leader = {
	            name = "Lightning Charm"
	            desc = BAT_LIGHTNING_CHARM_DESC
	            expire = "1965.1.1"
	            picture = "BAT_Autumn_Breeze.tga"
	            ideology = despotism
	            traits = {
	                BAT_dedicated_soldier
	            }
            }
			hidden_effect = { 
			    set_country_flag = { 
				    flag = BAT_changed_leader_flag 
					days = 365 
					value = 1 
				} 
			}
		}
	}
	
	BAT_appoint_palisade = {
		ai_will_do = {
			factor = 100
		}
		available = {
		    NOT = {
			    has_country_flag = BAT_changed_leader_flag
			}
		}
		visible = {
            OR = {
			    has_government = neutrality
				has_government = fascism
			}
			NOT = {
			    has_country_leader = { 
		            ruling_only = yes 
			        name = "Stone Palisade" 
		        }
			}
		}
        icon = lunar_war_plan
		
		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision BAT_appoint_lightning"
			custom_effect_tooltip = BAT_changed_leader_tp
			create_country_leader = {
	            name = "Stone Palisade"
	            desc = BAT_STONE_PALISADE_DESC
	            expire = "1965.1.1"
	            picture = "BAT_Autumn_Breeze.tga"
	            ideology = nazism
	            traits = {
	                BAT_dorn
	            }
            }
			create_country_leader = {
	            name = "Stone Palisade"
	            desc = BAT_STONE_PALISADE_DESC
	            expire = "1965.1.1"
	            picture = "BAT_Autumn_Breeze.tga"
	            ideology = despotism
	            traits = {
	                BAT_dorn
	            }
            }
			hidden_effect = { 
			    set_country_flag = { 
				    flag = BAT_changed_leader_flag 
					days = 365 
					value = 1 
				} 
			}
		}
	}
}

BAT_raiding = {
    BAT_prepare_raid = {
		icon = generic_operation
		available = {
			FROM = {
				any_owned_state = {
					is_controlled_by = FROM
					any_neighbor_state = {
						is_fully_controlled_by = ROOT
						set_temp_variable = { var:attacker_state_temp = id }
						has_ROOT_at_least_1_div_in_current_state_scope = yes
					}
					set_temp_variable = { var:defender_state_temp = id }
				}
			}
			NOT = { 
			    has_country_flag = raid_succeeded
			    has_country_flag = raid_failed
			    has_country_flag = raid_in_progress 
            }
		}

		visible = {
		    has_idea = BAT_slavery
			NOT = { 
                has_country_flag = preparing_raid
                has_war_with = FROM
                is_subject_of = FROM 
            }
			FROM = {
				can_have_border_war_with_ROOT = yes
			}
			OR = {
				NOT = { has_border_war_with = FROM }
				AND = {
					FROM = {
						any_owned_state = {
							is_controlled_by = FROM
							any_neighbor_state = {
								is_fully_controlled_by = ROOT
							}
						}
					}
				}
			}
		}
		target_array = neighbors
		target_trigger = {
			FROM = {
				is_neighbor_of = ROOT
			}
		}
		highlight_states = {
			OR = {
				state = FROM.defender_state_vs_@ROOT
				AND = {
					is_owned_and_controlled_by = FROM
					any_neighbor_state = {
						has_ROOT_at_least_1_div_in_current_state_scope = yes
						is_fully_controlled_by = ROOT
					}
				}
			}
		}
		ai_will_do = {
			base = 100
		}
		cost = 25
		fire_only_once = no
		days_re_enable = 90
		days_remove = 30

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision BAT_prepare_raid target: [From.GetName]"
			hidden_effect = {
				random_state = {
					limit = {
						is_owned_and_controlled_by = FROM
						any_neighbor_state = {
							has_ROOT_at_least_1_div_in_current_state_scope = yes
							is_fully_controlled_by = ROOT
						}
					}
					save_event_target_as = defender_state
					set_variable = { FROM.defender_state_vs_@ROOT = id }
					set_temp_variable = { defender_state_temp = id }
				}
				random_state = {
					limit = {
						is_fully_controlled_by = ROOT
						has_ROOT_at_least_1_div_in_current_state_scope = yes
						any_neighbor_state = {
							state = var:FROM.defender_state_vs_@ROOT
						}
					}
					save_event_target_as = attacker_state
					set_variable = { FROM.attacker_state_vs_@ROOT = id }
					set_temp_variable = { attacker_state_temp = id }
				}
				set_country_flag = preparing_raid
			}
		}
		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove prepare_raid target: [From.GetName]"
			activate_targeted_decision = { target = FROM decision = BAT_initiate_raid }
		}
	}

	BAT_initiate_raid = {
		icon = generic_operation
		allowed = { always = no } #Activated from effect
		available = {
			var:FROM.attacker_state_vs_@ROOT = {
				is_fully_controlled_by = ROOT
			}
			divisions_in_border_state = {
				state = var:FROM.attacker_state_vs_@ROOT
				border_state = var:FROM.defender_state_vs_@ROOT
				size > 0
			}
		}
		highlight_states = {
			state = var:FROM.attacker_state_vs_@ROOT
		}
		ai_will_do = {
			base = 100
		}
		cancel_trigger = {
			OR = {
                FROM = {
                    can_have_border_war_with_ROOT = no
                }
            }
		}
		fire_only_once = yes #Reactivation handled in effect
		selectable_mission = yes
		days_mission_timeout = 30

		timeout_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision timeout BAT_initiate_raid"
			hidden_effect = {
				FROM = {
					clear_variable = attacker_state_vs_@ROOT
					clear_variable = defender_state_vs_@ROOT
				}
				clr_country_flag = preparing_raid
				remove_targeted_decision = { target = FROM decision = BAT_initiate_raid }
				activate_targeted_decision = { target = FROM decision = BAT_prepare_raid }
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision initiate_raid"
			effect_tooltip = {
				start_border_war = {
					change_state_after_war = no
					attacker = {
						state = var:FROM.attacker_state_vs_@ROOT
						num_provinces = 4
						on_win = bat.1
						on_lose = bat.3
						on_cancel = bat.2
					}

					defender = {
						state = var:FROM.defender_state_vs_@ROOT
						num_provinces = 4
						on_win = bat.6
						on_lose = bat.4
						on_cancel = bat.5
					}
				}
			}
			hidden_effect = {
				if = {
					limit = { 
						FROM = { 
							OR = {
								is_ai = no
								AND = {
									has_war = yes
									divisions_in_border_state = {
										border_state = var:FROM.attacker_state_vs_@ROOT
										state = var:FROM.defender_state_vs_@ROOT
										size < 1
									}
								}
							}
						} 
					}
					FROM = { country_event = bat.7 }
				}
				else = {
					start_border_war = {
						change_state_after_war = no
						attacker = {
							state = var:FROM.attacker_state_vs_@ROOT
							num_provinces = 4
							on_win = bat.1
						    on_lose = bat.3
						    on_cancel = bat.2
						}
						defender = {
							state = var:FROM.defender_state_vs_@ROOT
							num_provinces = 4
							on_win = bat.6
						    on_lose = bat.4
						    on_cancel = bat.5
						}
					}
				}
			}
			hidden_effect = {
				set_country_flag = raid_in_progress
				clr_country_flag = preparing_raid
				remove_targeted_decision = { target = FROM decision = BAT_initiate_raid }
				activate_targeted_decision = { target = FROM decision = BAT_prepare_raid }
			}
		}
	}
}