NIM_remove_NCH_trade_category = {
	NIM_remove_NCH_trade = {
		icon = decision_infiltrate_state
		available = {
			original_tag = NIM
			has_country_flag = NCH_trading_with_flag
		}
		cost = 100
		ai_will_do = {
		
			factor = 1
			
			modifier = {
				has_idea = NCH_trading_with_NCH_harmonic
				factor = 0.01
			}
			modifier = {
				has_idea = NCH_trading_with_NCH_fascist
				factor = 80
			}
		}
		

		fire_only_once = yes

		visible = {
			original_tag = NIM
			has_country_flag = NCH_trading_with_flag
		}
		modifier = {
			
		}
		complete_effect = {
			if = {
				limit = {
					has_idea = NCH_trading_with_NCH_harmonic
				}
				remove_ideas = NCH_trading_with_NCH_harmonic
			}
			
			if = {
				limit = {
					has_idea = NCH_trading_with_NCH_fascist
				}
				remove_ideas = NCH_trading_with_NCH_fascist
			}
			
			clr_country_flag = NCH_trading_with_flag
			
			NCH = {
				if = {
					limit = {
						check_variable = { NCH_trade_partners_iter = 1 }
					}
					remove_ideas = NCH_trade_1
				}
				if = {
					limit = {
						check_variable = { NCH_trade_partners_iter = 2 }
					}
					swap_ideas = {add_idea = NCH_trade_1 remove_idea = NCH_trade_2}
				}
				if = {
					limit = {
						check_variable = { NCH_trade_partners_iter = 3 }
					}
					swap_ideas = {add_idea = NCH_trade_2 remove_idea = NCH_trade_3}
				}
				if = {
					limit = {
						check_variable = { NCH_trade_partners_iter = 4 }
					}
					swap_ideas = {add_idea = NCH_trade_3 remove_idea = NCH_trade_4}
				}

				add_to_variable = {
					var = NCH_trade_partners_iter
					value = -1
				}
				hidden_effect = { 
					add_to_variable = { var = gytha_sanity value = 1 } 
					country_event = {id = greneclyf.62 days = 1}
				} 
			}
		}
	}
}

NIM_boule_category = {
	NIM_harmony_ostracism_warning = {
		icon = anti_harmony
		activation = {
			has_completed_focus = NIM_choose_harmony
			democratic > 0.62
			is_ai = no
		}
		available = {
			OR = {
				democratic < 0.62
				has_completed_focus = NIM_the_law_of_freedom
			}
		}
		is_good = no
		days_mission_timeout = 70
		timeout_effect = {
			add_political_power = -150
			add_popularity = {
				ideology = democratic
				popularity = -0.2
			}
			add_stability = -0.07
		}
	}
	NIM_neutrality_ostracism_warning = {
		icon = generic_civil_support
		activation = {
			has_completed_focus = NIM_choose_neutrality
			neutrality > 0.62
			is_ai = no
		}
		available = {
			OR = {
				neutrality < 0.62
				has_completed_focus = NIM_the_law_of_virtue
			}
		}
		is_good = no
		days_mission_timeout = 70
		timeout_effect = {
			add_political_power = -150
			add_popularity = {
				ideology = neutrality
				popularity = -0.2
			}
			add_stability = -0.07
		}
	}
	NIM_fascism_ostracism_warning = {
		icon = anti_fascism
		activation = {
			has_completed_focus = NIM_choose_fascism
			fascism > 0.62
			is_ai = no
		}
		available = {
			OR = {
				fascism < 0.62
				has_completed_focus = NIM_suspend_ostracism
			}
		}
		is_good = no
		days_mission_timeout = 70
		timeout_effect = {
			add_political_power = -150
			add_popularity = {
				ideology = fascism
				popularity = -0.2
			}
			add_stability = -0.07
		}
	}
}

NIM_slave_crisis = {
	NIM_slave_crisis_mission = {
		available = {
			has_stability > 0.5
		}
		
		activation = {
			has_stability < 0.45
		}
		icon = revolt
		is_good = no
		days_mission_timeout = 120
		timeout_effect = {
			#TODO add
		}
	}
}

operations = {
	NIM_stop_atrocity = {
		icon = anti_fascism
		allowed = { always = no } #triggered directly
		selectable_mission = yes
		days_mission_timeout = 60
		is_good = no
		fire_only_once = yes
		war_with_target_on_complete = yes
		cancel_trigger = {
			hidden_trigger = {
				is_faction_leader = no
				NIM = {
					OR = {
						exists = no
						has_war_with = ROOT
						NOT = { has_government = fascism }
					}
				}
			}
		}
		timeout_effect = {
			add_political_power = -50
			custom_effect_tooltip = RIV_fed_race_minus1_tt
			subtract_from_variable = { var = RIV_fed_race value = 1 }
		}
		complete_effect = {
			declare_war_on = { target = FROM type = puppet_wargoal_focus }
		}
		ai_will_do = {
			factor = 10
			modifier = {
				factor = 0.5
				strength_ratio = {
					tag = NIM
					ratio < 1
				}
			}
			modifier = {
				factor = 0
				strength_ratio = {
					tag = NIM
					ratio < 0.65
				}
			}
			modifier = {
				factor = 0
				has_government = fascism
			}
		}
	}
}