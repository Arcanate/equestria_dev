calculate_TRO_CTH_corruption = {
	set_temp_variable = { TRO_CTH_corruption_temp = TRO_CTH_corruption } # Copy variable between 0 and 100
	subtract_from_temp_variable = { TRO_CTH_corruption_temp = 50 } #Variable is now between -50 to 50
	divide_temp_variable = { TRO_CTH_corruption_temp = 50 } #Variable is now -1 to 1

	set_temp_variable = { TRO_CTH_corruption_min_ppf = -0.15 }
	set_temp_variable = { TRO_CTH_corruption_min_wkstab = -0.005 }
	set_temp_variable = { TRO_CTH_corruption_min_indcap = -0.1 }
	set_temp_variable = { TRO_CTH_corruption_min_moralf = -0.1 }

	set_temp_variable = { TRO_CTH_corruption_max_locresf = 0.15 }
	set_temp_variable = { TRO_CTH_corruption_max_compgain = 0.1 }
	set_temp_variable = { TRO_CTH_corruption_max_consgood = -0.1 }
	set_temp_variable = { TRO_CTH_corruption_max_supplycomp = -0.1 }

	multiply_temp_variable = { TRO_CTH_corruption_min_ppf = TRO_CTH_corruption_temp}
	multiply_temp_variable = { TRO_CTH_corruption_min_wkstab = TRO_CTH_corruption_temp}
	multiply_temp_variable = { TRO_CTH_corruption_min_indcap = TRO_CTH_corruption_temp}
	multiply_temp_variable = { TRO_CTH_corruption_min_moralf = TRO_CTH_corruption_temp}
	multiply_temp_variable = { TRO_CTH_corruption_max_locresf = TRO_CTH_corruption_temp}
	multiply_temp_variable = { TRO_CTH_corruption_max_compgain = TRO_CTH_corruption_temp}
	multiply_temp_variable = { TRO_CTH_corruption_max_consgood = TRO_CTH_corruption_temp}
	multiply_temp_variable = { TRO_CTH_corruption_max_supplycomp = TRO_CTH_corruption_temp}

	set_variable = { modif_TRO_CTH_corruption_min_ppf = TRO_CTH_corruption_min_ppf}
	set_variable = { modif_TRO_CTH_corruption_min_wkstab = TRO_CTH_corruption_min_wkstab}
	set_variable = { modif_TRO_CTH_corruption_min_indcap = TRO_CTH_corruption_min_indcap}
	set_variable = { modif_TRO_CTH_corruption_min_moralf = TRO_CTH_corruption_min_moralf}
	set_variable = { modif_TRO_CTH_corruption_max_locresf = TRO_CTH_corruption_max_locresf}
	set_variable = { modif_TRO_CTH_corruption_max_compgain = TRO_CTH_corruption_max_compgain}
	set_variable = { modif_TRO_CTH_corruption_max_consgood = TRO_CTH_corruption_max_consgood}
	set_variable = { modif_TRO_CTH_corruption_max_supplycomp = TRO_CTH_corruption_max_supplycomp}
	force_update_dynamic_modifier = yes
	
	TRO_calculate_corruption_karma_gui = yes
}

# x = 2.62a + 81 where a is the corruption var.
TRO_calculate_corruption_karma_gui = {
	set_temp_variable = { x_calc = TRO_CTH_corruption }
	multiply_temp_variable = { x_calc = 2.62 }
	add_to_temp_variable = { x_calc = 81 }
	set_variable = { TRO_corruption_karma_x = x_calc }
}

TRO_modify_army_of_the_republic = {
	custom_effect_tooltip = TRO_CTH_army_reforms_main_tp
	add_to_variable = { TRO_CTH_army_conscription_factor_var = temp_conscription_factor }
	add_to_variable = { TRO_CTH_planning_speed_factor_var = temp_planning }
	add_to_variable = { TRO_CTH_mobilization_speed_var = temp_mob }
	add_to_variable = { TRO_CTH_conscription_var = temp_conscription }
	add_to_variable = { TRO_CTH_army_org_regain_var = temp_army_org_regain }
	add_to_variable = { TRO_CTH_training_time_factor_var = temp_training_time_factor }
	add_to_variable = { TRO_CTH_army_fuel_consumption_factor_var = temp_army_fuel_consumption_factor }
	add_to_variable = { TRO_CTH_industrial_capacity_factory_1_var = temp_industrial_capacity_factory }
	add_to_variable = { TRO_CTH_army_defence_factor_var = temp_army_defence_factor }
	add_to_variable = { TRO_CTH_no_supply_grace_var = temp_no_supply_factor }
	add_to_variable = { TRO_CTH_supply_consumption_factor_var = temp_supply_consumption_factor }
	add_to_variable = { TRO_CTH_modifier_army_sub_unit_spirit_warriors_attack_factor_var = temp_chargers }
	add_to_variable = { TRO_CTH_production_factory_start_efficiency_factor_var = temp_production_start_eff_factor }
	add_to_variable = { TRO_CTH_special_forces_attack_factor_var = temp_sf_attack }
	add_to_variable = { TRO_CTH_army_org_factor_var = temp_army_org_factor }
	add_to_variable = { TRO_CTH_army_speed_factor_var = temp_army_speed_factor }
	add_to_variable = { TRO_CTH_out_of_supply_factor_var = temp_out_of_supply_factor }
	add_to_variable = { TRO_CTH_org_loss_when_moving_var = temp_org_loss_when_moving }
	add_to_variable = { TRO_CTH_army_attack_factor_var = temp_army_attack_factor }
	add_to_variable = { TRO_CTH_special_forces_cap_var = temp_special_forces_cap }
	add_to_variable = { TRO_CTH_army_morale_factor_var = temp_army_morale_factor }
	force_update_dynamic_modifier = yes
}

TRO_modify_economic_development = {
	custom_effect_tooltip = TRO_CTH_economic_development_main_tp
	add_to_variable = { TRO_CTH_consumer_goods_var = temp_consumer_goods }
	add_to_variable = { TRO_CTH_monthly_population_var = temp_monthly_pop }
	add_to_variable = { TRO_CTH_political_power_factor_1_var = temp_pp_factor }
	add_to_variable = { TRO_CTH_global_building_slots_factor_var = temp_global_building_slots }
	add_to_variable = { TRO_CTH_trade_opinion_factor_var = temp_trade_opinion }
	add_to_variable = { TRO_CTH_min_export_var = temp_min_export }
	add_to_variable = { TRO_CTH_industrial_capacity_factory_2_var = temp_ic }
	add_to_variable = { TRO_CTH_local_resources_factor_var = temp_local_resources }
	add_to_variable = { TRO_CTH_stability_weekly_1_var = temp_weekly_stability }
	add_to_variable = { TRO_CTH_production_factory_start_efficiency_factor_var_2 = temp_start_eff_2 }
	add_to_variable = { TRO_CTH_production_speed_buildings_factor_var = temp_construction }
	add_to_variable = { TRO_CTH_production_factory_efficiency_gain_factor_var = temp_eff_gain }
	force_update_dynamic_modifier = yes
}

TRO_CTH_modify_social_policy_modifier = {
	custom_effect_tooltip = TRO_CTH_social_policy_modifier_main_tp
	add_to_variable = { TRO_CTH_stability_weekly_2_var = temp_weekly_stability }
	add_to_variable = { TRO_CTH_weekly_war_support_var = temp_weekly_war_support }
	add_to_variable = { TRO_CTH_army_conscription_factor_2_var = temp_conscription_factor }
	add_to_variable = { TRO_CTH_consumer_goods_2_var = temp_consumer_goods }
	add_to_variable = { TRO_CTH_research_speed_var = temp_research_speed }
	add_to_variable = { TRO_CTH_political_advisor_cost_factor_2_var = temp_political_advisor_cost_factor }
	add_to_variable = { TRO_CTH_compliance_growth_var = temp_compliance_growth }
	add_to_variable = { TRO_CTH_resistance_damage_to_garrison_var = temp_resistance_damage_to_garrison }
	add_to_variable = { TRO_CTH_resistance_growth_var = temp_resistance_growth }
	add_to_variable = { TRO_CTH_required_garrison_factor_var = temp_required_garrison_factor }
	add_to_variable = { TRO_CTH_political_power_factor_3_var = temp_pp_factor }
	add_to_variable = { TRO_CTH_local_resources_factor_2_var = temp_local_resources }
	force_update_dynamic_modifier = yes
}

TRO_CTH_modify_politics_modifier = {
	custom_effect_tooltip = TRO_CTH_politics_modifier_main_tp
	add_to_variable = { TRO_CTH_political_power_factor_2_var = temp_pp_factor }
	add_to_variable = { TRO_CTH_war_stability_factor_var = temp_war_stability_factor }
	add_to_variable = { TRO_CTH_fascism_drift_var = temp_fascism_drift }
	add_to_variable = { TRO_CTH_political_advisor_cost_factor_var = temp_political_advisor_cost_factor }
	add_to_variable = { TRO_CTH_party_popularity_stability_factor_var = temp_party_popularity_stability_factor }
	add_to_variable = { TRO_CTH_stability_factor_var = temp_stability_factor }
	add_to_variable = { TRO_CTH_production_factory_efficiency_gain_factor_2_var = temp_eff_gain }
	add_to_variable = { TRO_CTH_industrial_capacity_factory_3_var = temp_ic }
	add_to_variable = { TRO_CTH_consumer_goods_3_var = temp_consumer_goods_2 }
	add_to_variable = { TRO_CTH_research_speed_2_var = temp_research_speed_2 }
	add_to_variable = { TRO_CTH_neutrality_drift_var = temp_neutrality_drift }
	force_update_dynamic_modifier = yes
}

# Join the war on drugs (On the side of the drugs)

TRO_join_the_war_on_drugs_on_the_side_of_the_drugs = {
	set_country_flag = TRO_CTH_enable_drugs_lmao
	
	# Mid section setup
	clear_array = TRO_drugs_dummy_midsection
	add_to_array = { TRO_drugs_dummy_midsection = 0 }
	
	clear_array = TRO_drugs_friendly_power_status
	clear_array = TRO_drugs_friendly_relations_status
	resize_array = {
		array = TRO_drugs_friendly_power_status
		value = 0
		size = 5
	}
	resize_array = {
		array = TRO_drugs_friendly_relations_status
		value = 0
		size = 5
	}
	
	clear_array = TRO_drugs_enemy_influence_status
	clear_array = TRO_drugs_enemy_control_status
	clear_array = TRO_drugs_enemy_aggression_status
	resize_array = {
		array = TRO_drugs_enemy_influence_status
		value = 0
		size = 5
	}
	resize_array = {
		array = TRO_drugs_enemy_control_status
		value = 0
		size = 5
	}
	resize_array = {
		array = TRO_drugs_enemy_aggression_status
		value = 0
		size = 5
	}
	
	# Map gui setup
	clear_array = TRO_drugs_map_array
	clear_array = TRO_drugs_map_x
	clear_array = TRO_drugs_map_y

	add_to_array = { TRO_drugs_map_array = 699 }
	add_to_array = { TRO_drugs_map_array = 852 }
	add_to_array = { TRO_drugs_map_array = 875 }
	add_to_array = { TRO_drugs_map_array = 877 }
	add_to_array = { TRO_drugs_map_array = 700 }
	add_to_array = { TRO_drugs_map_array = 701 }
	add_to_array = { TRO_drugs_map_array = 702 }
	add_to_array = { TRO_drugs_map_array = 876 }
	add_to_array = { TRO_drugs_map_array = 703 }
	add_to_array = { TRO_drugs_map_array = 704 }
	add_to_array = { TRO_drugs_map_array = 705 }
	add_to_array = { TRO_drugs_map_array = 706 }
	add_to_array = { TRO_drugs_map_array = 709 }
	add_to_array = { TRO_drugs_map_array = 714 }
	add_to_array = { TRO_drugs_map_array = 1093 }
	add_to_array = { TRO_drugs_map_array = 1094 }
	add_to_array = { TRO_drugs_map_array = 1095 }
	
	add_to_array = { TRO_drugs_map_x = 6 } # 699
	add_to_array = { TRO_drugs_map_y = 69 }

	add_to_array = { TRO_drugs_map_x = 60 } # 852
	add_to_array = { TRO_drugs_map_y = 35 }

	add_to_array = { TRO_drugs_map_x = 183 } # 875
	add_to_array = { TRO_drugs_map_y = 92 }

	add_to_array = { TRO_drugs_map_x = 35 } # 877
	add_to_array = { TRO_drugs_map_y = 77 }
	
	add_to_array = { TRO_drugs_map_x = 123 } # 700
	add_to_array = { TRO_drugs_map_y = 60 }

	add_to_array = { TRO_drugs_map_x = 153 } # 701
	add_to_array = { TRO_drugs_map_y = 43 }

	add_to_array = { TRO_drugs_map_x = 138 } # 702
	add_to_array = { TRO_drugs_map_y = 104 }

	add_to_array = { TRO_drugs_map_x = 124 } # 876
	add_to_array = { TRO_drugs_map_y = 129 }

	add_to_array = { TRO_drugs_map_x = 225 } # 703
	add_to_array = { TRO_drugs_map_y = 19 }

	add_to_array = { TRO_drugs_map_x = 252 } # 704
	add_to_array = { TRO_drugs_map_y = 48 }

	add_to_array = { TRO_drugs_map_x = 303 } # 705
	add_to_array = { TRO_drugs_map_y = 23 }

	add_to_array = { TRO_drugs_map_x = 305 } # 706
	add_to_array = { TRO_drugs_map_y = 50 }

	add_to_array = { TRO_drugs_map_x = 77 } # 709
	add_to_array = { TRO_drugs_map_y = 98 }

	add_to_array = { TRO_drugs_map_x = 300 } # 714
	add_to_array = { TRO_drugs_map_y = 5 }

	add_to_array = { TRO_drugs_map_x = 366 } # 1093
	add_to_array = { TRO_drugs_map_y = 30 }

	add_to_array = { TRO_drugs_map_x = 394 } # 1094
	add_to_array = { TRO_drugs_map_y = 58 }

	add_to_array = { TRO_drugs_map_x = 455 } # 1095
	add_to_array = { TRO_drugs_map_y = 23 }
	
	# States control setup
	set_variable = { 699.TRO_drugs_ruling_cartel = 1 }
	set_variable = { 700.TRO_drugs_ruling_cartel = 2 }
	set_variable = { 701.TRO_drugs_ruling_cartel = 0 }
	set_variable = { 702.TRO_drugs_ruling_cartel = 3 }
	set_variable = { 703.TRO_drugs_ruling_cartel = 1 }
	set_variable = { 704.TRO_drugs_ruling_cartel = 4 }
	set_variable = { 705.TRO_drugs_ruling_cartel = 0 }
	set_variable = { 706.TRO_drugs_ruling_cartel = 4 }
	set_variable = { 709.TRO_drugs_ruling_cartel = 2 }
	set_variable = { 714.TRO_drugs_ruling_cartel = 1 }
	set_variable = { 852.TRO_drugs_ruling_cartel = 2 }
	set_variable = { 875.TRO_drugs_ruling_cartel = 5 }
	set_variable = { 876.TRO_drugs_ruling_cartel = 3 }
	set_variable = { 877.TRO_drugs_ruling_cartel = 0 }
	set_variable = { 1093.TRO_drugs_ruling_cartel = 0 }
	set_variable = { 1094.TRO_drugs_ruling_cartel = 4 }
	set_variable = { 1095.TRO_drugs_ruling_cartel = 0 }
	
	add_to_variable = { TRO_drugs_dirty_bit = 0.001 }
}
