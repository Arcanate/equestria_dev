EQS_create_new_commanders = {
create_corps_commander = {
  name = "Applejack"
   portrait_path = "gfx/leaders/EQS/Applejack.dds"
   traits = { trickster ranger }
   skill = 1
}
create_corps_commander = {
  name = "Surprise"
  portrait_path = "gfx/leaders/EQS/Surprise.dds"
   traits = {  }
  skill = 2
        }
create_corps_commander = {
  name = "Big Macintosh"
  portrait_path = "gfx/leaders/EQS/BigMac.tga"
   traits = {  }
  skill = 1
        }
create_corps_commander = {
  name = "Braeburn"
  id = 10000
  portrait_path = "gfx/leaders/EQS/Braeburn.tga"
   traits = { urban_assault_specialist }
  skill = 2
        }
create_corps_commander = {
  name = "Pinkamena Diana Pie"
  portrait_path = "gfx/leaders/EQS/PinkiePie.tga"
   traits = { pinkie_pie_bae }
  skill = 3
        }
create_corps_commander = {
  name = "Caltrop Deekay"
  portrait_path = "gfx/leaders/EQS/Gamma.tga"
   traits = { panzer_leader }
  skill = 3
        }
create_corps_commander = {
  name = "Kaiserslautern"
  portrait_path = "gfx/leaders/EQS/mageytash.tga"
   traits = { }
  skill = 2
        }
create_corps_commander = {
    name = "Fizzlepop Berrytwist"
    portrait_path = "gfx/leaders/EQS/TempestShadow.tga"
    traits = { fortress_buster }
    skill = 3
        }
}

#ROOT is EQS
EQS_SOL_wartime_change = {
  SOL = {
    if = {
      limit = { 3 = { NOT = { is_owned_and_controlled_by = EQS }} }
      EQS = {
        random_owned_controlled_state = {
          SOL = { transfer_state = PREV }
        }
      }
      else = { transfer_state = 3 }
    }
    if = {
      limit = { EQS = { amount_research_slots > 4  } }
      add_research_slot = 1
    }
    if = {
      limit = { EQS = { amount_research_slots > 3 } }
      add_research_slot = 1
    }
    if = {
      limit = { EQS = { has_idea = eqs_war_admin_extreme } }
      add_ideas = eqs_war_admin_extreme
      EQS = { remove_ideas = eqs_war_admin_extreme }
    }
    if = {
      limit = { EQS = { has_idea = eqs_war_law_extreme } }
      add_ideas = eqs_war_law_extreme
      EQS = { remove_ideas = eqs_war_law_extreme }
    }
    if = {
      limit = { EQS = { has_idea = eqs_media_control } }
      add_ideas = eqs_media_control
      EQS = { remove_ideas = eqs_media_control }
    }
    if = {
      limit = { EQS = { has_idea = eqs_order_idea } }
      add_ideas = eqs_order_idea
      EQS = { remove_ideas = eqs_order_idea }
    }
    if = {
      limit = { EQS = { has_idea = unicorn_academy } }
      add_ideas = unicorn_academy
    }
    if = {
      limit = { EQS = { has_idea = unicorn_academy1 } }
      add_ideas = unicorn_academy1
    }
    if = {
      limit = { EQS = { has_idea = unicorn_academy2 } }
      add_ideas = unicorn_academy2
    }
    if = {
      limit = { EQS = { has_idea = sombra_defenses } }
      add_ideas = sombra_defenses
    }
    if = {
      limit = { EQS = { has_idea = war_plan_equestria } }
      add_ideas = war_plan_equestria
    }
    if = {
      limit = { EQS = { has_idea = war_plan_equestria_mild } }
      add_ideas = war_plan_equestria_mild
    }
    if = {
      limit = { EQS = { has_idea = war_plan_equestria_extreme } }
      add_ideas = war_plan_equestria_extreme
    }
    if = {
      limit = { EQS = { has_idea = eqs_ai_buff } }
      add_ideas = eqs_ai_buff
    }
    if = {
      limit = { EQS = { has_idea = eqs_ai_buff2 } }
      add_ideas = eqs_ai_buff2
    }
    if = {
      limit = { EQS = { has_idea = magical_trainingidea } }
      add_ideas = magical_trainingidea
    }
    if = {
      limit = { EQS = { has_idea = nuclear_power_EQS } }
      add_ideas = nuclear_power_EQS
    }
    if = {
      limit = { EQS = { has_idea = service_by_requirement } }
      add_ideas = service_by_requirement
    }
    if = {
      limit = { EQS = { has_idea = all_adults_serve } }
      add_ideas = all_adults_serve
    }
    if = {
      limit = { EQS = { has_idea = scraping_the_barrel } }
      add_ideas = scraping_the_barrel
    }
    if = {
      limit = { EQS = { has_idea = war_economy } }
      add_ideas = war_economy
    }
    if = {
      limit = { EQS = { has_idea = tot_economic_mobilisation } }
      add_ideas = tot_economic_mobilisation
    }
    if = {
      limit = { EQS = { has_idea = limited_exports } }
      add_ideas = limited_exports
    }
    if = {
      limit = { EQS = { has_idea = closed_economy } }
      add_ideas = closed_economy
    }
    if = {
      limit = { EQS = { surrender_progress > 0.49 } }
      add_timed_idea = { idea = SOL_start_buff days = 90 }
    }
    if = {
      limit = { EQS = { has_completed_focus = Hire_Generals } }
      EQS_create_new_commanders = yes
    }
  }
  retire_country_leader = yes
  if = {
    limit = { has_unit_leader = 9999 }
    remove_unit_leader = 9999
  }
  if = {
    limit = {
      has_idea = alicorn_sisters
    }
    create_country_leader = {
      name = "Princess Luna"
      desc = "LUNA_DESC"
      picture = "Luna.tga"
      expire = "1965.1.1"
      ideology = alicornrule
      traits = {
      }
    }
    SOL = { add_national_unity = -0.1 }
    remove_ideas = alicorn_sisters
  }
  if = {
    limit = { is_in_faction = yes }
    add_to_faction = SOL
  }
  every_enemy_country = {
    SOL = { add_to_war = { targeted_alliance = EQS enemy = PREV } }
  }
  SOL = { set_politics = { ruling_party = democratic elections_allowed = no } }
  every_country = {
    limit = { is_subject_of = EQS }
    if = {
      limit = { has_dlc = "Together for Victory" }
      if = {
        limit = { has_autonomy_state = autonomy_integrated_puppet }
        SOL = { puppet = PREV }
        add_autonomy_ratio = { value = -0.15 }
        else = {
          if = {
            limit = { has_autonomy_state = autonomy_colony }
            SOL = { puppet = PREV }
            add_autonomy_ratio = { value = 0.55 }
            else = {
              if = {
                limit = { has_autonomy_state = autonomy_dominion }
                SOL = { puppet = PREV }
                add_autonomy_ratio = { value = 0.80 }
                else = {
                  if = {
                    limit = { has_autonomy_state = autonomy_puppet }
                    SOL = { puppet = PREV }
                  }
                }
              }
            }
          }
        }
      }
      else = { SOL = { puppet = PREV } }
    }
  }
  SOL = {
    country_event = civwar.110
    change_tag_from = EQS
    }
  country_event = equestria.156
}

#ROOT is EQS
EQS_SOL_civil_war = {
	set_global_flag = equestrian_civil_war_daybreaker
	if = {
		limit = {
			NOT = { has_idea = alicorn_sisters }
		}
			add_popularity = {
				ideology = fascism
				popularity = 0.10
			}
		}
			if = {
				limit = { has_unit_leader = 9999 }
				remove_unit_leader = 9999
			}
			add_national_unity = -0.1
			SOL = {
				if = {
					limit = { 3 = { NOT = { is_owned_and_controlled_by = EQS }} }
					EQS = {
						random_owned_controlled_state = {
							SOL = { transfer_state = PREV }
						}
					}
					else = { transfer_state = 3 }
				}
        if = {
          limit = { EQS = { amount_research_slots > 4 } }
          add_research_slot = 1
        }
        if = {
          limit = { EQS = { amount_research_slots > 3  } }
          add_research_slot = 1
        }
				if = {
					limit = { EQS = { has_idea = unicorn_academy } }
					add_ideas = unicorn_academy
				}
				if = {
					limit = { EQS = { has_idea = unicorn_academy1 } }
					add_ideas = unicorn_academy1
				}
				if = {
					limit = { EQS = { has_idea = unicorn_academy2 } }
					add_ideas = unicorn_academy2
				}
				if = {
					limit = { EQS = { has_idea = sombra_defenses } }
					add_ideas = sombra_defenses
				}
				if = {
					limit = { EQS = { has_idea = war_plan_equestria } }
					add_ideas = war_plan_equestria
				}
				if = {
					limit = { EQS = { has_idea = war_plan_equestria_mild } }
					add_ideas = war_plan_equestria_mild
				}
				if = {
					limit = { EQS = { has_idea = war_plan_equestria_extreme } }
					add_ideas = war_plan_equestria_extreme
				}
				if = {
					limit = { EQS = { has_idea = eqs_ai_buff } }
					add_ideas = eqs_ai_buff
				}
				if = {
					limit = { EQS = { has_idea = eqs_ai_buff2 } }
					add_ideas = eqs_ai_buff2
				}
				if = {
					limit = { EQS = { has_idea = eqs_war_admin_extreme } }
					add_ideas = eqs_war_admin_extreme
					EQS = { remove_ideas = eqs_war_admin_extreme }
				}
				if = {
					limit = { EQS = { has_idea = eqs_war_law_extreme } }
					add_ideas = eqs_war_law_extreme
					EQS = { remove_ideas = eqs_war_law_extreme }
				}
				if = {
					limit = { EQS = { has_idea = eqs_media_control } }
					add_ideas = eqs_media_control
					EQS = { remove_ideas = eqs_media_control }
				}
				if = {
					limit = { EQS = { has_idea = eqs_order_idea } }
					add_ideas = eqs_order_idea
					EQS = { remove_ideas = eqs_order_idea }
				}
				if = {
					limit = { EQS = { has_idea = magical_trainingidea } }
					add_ideas = magical_trainingidea
				}
				if = {
					limit = { EQS = { has_idea = nuclear_power_EQS } }
					add_ideas = nuclear_power_EQS
				}
			}
			if = {
				limit = { fascism > 0.7 }
				start_civil_war = {
					ruling_party = democratic
					ideology = fascism
					size = 0.8
					states = {
						100
						101
						103
						104
						105
						114
						117
						118
						119
						121
						123
						124
						125
						126
						127
						128
						129
						130
						131
						134
						135
						136
						137
						138
						14
						169
						170
						171
						172
						173
						174
						175
						176
						178
						179
						180
						181
						18
						19
						20
						21
						221
						23
						241
						2
						38
						3
						41
						42
						43
						44
						45
						46
						47
						48
						4
						51
						54
						56
						66
						68
						70
						71
						72
						73
						74
						80
						83
						85
						87
						91
						92
						93
						94
						95
						96
						99
						49
						59
						60
						61
						133
						132
						15
						34
						50
						22
						16
						24
						352
						351
						33
						26
						52
						86
						81
						32
						155
						156
						326
						164
						160
						157
						122
						120
					}
				}
				else = {
					if = {
						limit = { fascism > 0.5 }
						start_civil_war = {
							ruling_party = democratic
							ideology = fascism
							size = 0.65
							states = {
							100
							101
							103
							104
							105
							114
							117
							118
							119
							121
							123
							124
							125
							126
							127
							128
							129
							130
							131
							134
							135
							136
							137
							138
							14
							169
							170
							171
							172
							173
							174
							175
							176
							178
							179
							180
							181
							18
							19
							20
							21
							221
							23
							241
							2
							38
							3
							41
							42
							43
							44
							45
							46
							47
							48
							4
							51
							54
							56
							66
							68
							70
							71
							72
							73
							74
							80
							83
							85
							87
							91
							92
							93
							94
							95
							96
							99
							49
							59
							60
							61
							133
							132
							15
							34
							50
							22
							16
							24
							352
							}
						}
						else = {
							start_civil_war = {
								ruling_party = democratic
								ideology = fascism
								size = 0.5
								states = {
									100
									101
									103
									104
									105
									114
									117
									118
									119
									121
									123
									124
									125
									126
									127
									128
									129
									130
									131
									134
									135
									136
									137
									138
									14
									169
									170
									171
									172
									173
									174
									175
									176
									178
									179
									180
									181
									18
									19
									20
									21
									221
									23
									241
									2
									38
									3
									41
									42
									43
									44
									45
									46
									47
									48
									4
									51
									54
									56
									66
									68
									70
									71
									72
									73
									74
									80
									83
									85
									87
									91
									92
									93
									94
									95
									96
									99
								}
							}
						}
					}
				}
			}
			add_popularity = {
				ideology = fascism
				popularity = -0.35
			}
			hidden_effect = {
				retire_country_leader = yes
			}
			if = {
				limit = {
					has_idea = alicorn_sisters
				}
			create_country_leader = {
				name = "Princess Luna"
				desc = "LUNA_DESC"
				picture = "Luna.tga"
				expire = "1965.1.1"
				ideology = alicornrule
				traits = {
				}
			}
			remove_ideas = alicorn_sisters
			}
			set_equipment_fraction = 0.5
			add_ideas = eqs_civil_war
			random_other_country = {
				limit = {
					original_tag = EQS
					has_government = fascism
				}
				set_equipment_fraction = 0.5
				country_event = equestria.155
			}
	}

	Evil_unicorn_magic = {
	if = {
		limit = {
			PREV = {
				has_tech = tech_unicorn_th
			}
		}
		if = {
			limit = {
				has_government = fascism
			}
			set_technology = {
				tech_unicorn_ms = 1
			}
			else = {
				set_technology = {
					tech_unicorn_th = 1
				}
			}
		}
	}

	if = {
		limit = {
			PREV = {
				has_tech = tech_unicorn_th2
			}
		}
		if = {
			limit = {
				has_government = fascism
			}
			set_technology = {
				tech_unicorn_ms2 = 1
			}
			else = {
				set_technology = {
					tech_unicorn_th2 = 1
				}
			}
		}
	}

	if = {
		limit = {
			PREV = {
				has_tech = tech_unicorn_th3
			}
		}
		if = {
			limit = {
				has_government = fascism
			}
			set_technology = {
				tech_unicorn_ms3 = 1
			}
			else = {
				set_technology = {
					tech_unicorn_th3 = 1
				}
			}
		}
	}

	if = {
		limit = {
			PREV = {
				has_tech = tech_unicorn_th4
			}
		}
		if = {
			limit = {
				has_government = fascism
			}
			set_technology = {
				tech_unicorn_ms4 = 1
			}
			else = {
				set_technology = {
					tech_unicorn_th4 = 1
				}
			}
		}
	}

	if = {
		limit = {
			PREV = {
				has_tech = tech_unicorn_th5
			}
		}
		if = {
			limit = {
				has_government = fascism
			}
			set_technology = {
				tech_unicorn_ms5 = 1
			}
			else = {
				set_technology = {
					tech_unicorn_th5 = 1
				}
			}
		}
	}
}
