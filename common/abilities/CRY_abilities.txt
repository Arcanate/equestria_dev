ability = {

	melammu_dingir_attack = {
		name = ABILITY_MELAMMU_DINGIR_ATTACK
		desc = ABILITY_MELAMMU_DINGIR_ATTACK_DESC
		icon = GFX_ability_chi_force_attack

		sound_effect = command_power_ability_offensive

		type = army_leader

		allowed = {
			is_leading_army_group = no
			is_border_war = no
			owner = {
				has_country_flag = CRY_melammu_dingir
			}
		}

		ai_will_do = {
			factor = -1
			modifier = {
				FROM = {
					has_war_support > 0.1
					command_power > 1.5
				}
				check_variable = { num_units_offensive_combats > 6 }

				set_temp_variable = { temp = avg_offensive_combat_status }
				check_variable = { temp > 0.45 }
				check_variable = { ai_random > temp }

				add = 2
			}
		}

		cost = 1
		duration = 168

		one_time_effect = {
			add_temporary_buff_to_units = {
				combat_offense = 0.4
				combat_breakthrough = 0.4
				org_damage_multiplier = -0.8
				str_damage_multiplier = -0.5

				days = 7
				tooltip = ABILITY_MELAMMU_DINGIR_ATTACK_TOOLTIP
			}
		}
		
		unit_modifiers = {
			fort = {
				attack = 0.1
			}
			fortification_damage = 1.0
			fortification_collateral_chance = 1.0
		
			dont_lose_dig_in_on_attack = 1.0
			supply_consumption_factor = 0.1
			army_speed_factor = -0.1
		}
	}
	
	melammu_dingir_def = {
		name = ABILITY_MELAMMU_DINGIR_DEF
		desc = ABILITY_MELAMMU_DINGIR_DEF_DESC
		icon = GFX_ability_jap_last_stand

		sound_effect = command_power_ability_offensive

		type = army_leader

		allowed = {
			is_leading_army_group = no
			is_border_war = no
			owner = {
				has_country_flag = CRY_melammu_dingir
			}
		}

		cost = 0.25
		duration = 168

		one_time_effect = {
			add_temporary_buff_to_units = {
				combat_defense = 0.3
				combat_entrenchment = 0.25
				org_damage_multiplier = -1.0
				str_damage_multiplier = -0.25

				days = 7
				tooltip = ABILITY_MELAMMU_DINGIR_DEF_TOOLTIP
			}
		}
		
		unit_modifiers = {
			supply_consumption_factor = 0.1
			army_speed_factor = -0.1
		}

		ai_will_do = {
			factor = -1
			modifier = {
				FROM = {
					has_war_support > 0.4
				}

				check_variable = { num_units_defensive_combats > 6 }

				set_temp_variable = { temp = avg_defensive_combat_status }
				check_variable = { temp < 0.40 }
				check_variable = { ai_random > temp }

				add = 2
			}
		}
	}
}