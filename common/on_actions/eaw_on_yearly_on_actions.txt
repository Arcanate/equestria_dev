on_actions = {
	on_startup = { # on_daily is executed before on_startup
		effect = {
			add_to_variable = { global.next_month = 1 }
			
			NTR = {
				# Famine stuff
				country_event = { id = Ntribes.998 days = 274 random = 709 } # October-November
			}
		}
	}
	
	# ROOT is country, this is ran for every country
	on_daily = {
		effect = {
			# ON MONTHLY
			if = {
				# don't touch!
				limit = {
					NOT = { has_global_flag = on_monthly_done }
					meta_trigger = {
						text = {
							date > [YEAR].[MONTH].1
						}
						YEAR = "[?global.year]"
						MONTH = "[?global.next_month]"
					}
				}
				
				log = "[GetMonth]: [Root.GetName]: on_MONTHLY"
				
				add_to_variable = { global.month = 1 }
				add_to_variable = { global.next_month = 1 }
				set_global_flag = { flag = on_monthly_done value = 1 days = 27 }
				
				if = { # ON YEARLY was included in the check for January, since this is a more logical IMO.
					limit = { check_variable = { global.month > 12 } }
					set_variable = { global.month = 1 }
					
					SRS = { country_event = socrep_grif.76 }
					
					NTR = {
						# Famine stuff
						set_variable = { NTR_next_year_agricultural_support_var = 1 }
						country_event = { id = Ntribes.998 days = 274 random = 720 } # October-November
					}
				}
				else_if = {
					limit = { check_variable = { global.next_month > 12 } }
					set_variable = { global.next_month = 1 }
					set_global_flag = { flag = on_monthly_done value = 1 days = 31 }
				}
				
				# this is done only ONCE per month, even though on_daily fires for every country
				# will also be done on startup
				
				# your code here
				every_country = {
					limit = {
						any_of_scopes = {
							array = controlled_states
							
							has_variable = SM_state_monthly_population_var
						}
					}
					
					set_temp_variable = { SM_state_monthly_population_multiplier_temp_var = 0.012 }
					add_to_temp_variable = { SM_state_monthly_population_multiplier_temp_var = modifier@monthly_population }
					
					for_each_scope_loop = {
						array = controlled_states
						
						set_temp_variable = { SM_state_monthly_population_temp_var = CONTROLLER.SM_state_monthly_population_multiplier_temp_var }
						multiply_temp_variable = { SM_state_monthly_population_temp_var = state_population_k }
						multiply_temp_variable = { SM_state_monthly_population_temp_var = SM_state_monthly_population_var }
						multiply_temp_variable = { SM_state_monthly_population_temp_var = 1000 }
						
						add_manpower = SM_state_monthly_population_temp_var
					}
				}
				
				if = {
					limit = {
						OR = {
							has_global_flag = EaW_winter_system_on_global_flag
							
							country_exists = NTR # frosen_seas_dynamic_modifier
						}
						
						OR = {
							check_variable = { global.month < 7 }
							check_variable = { global.month > 9 }
						}
					}
					
					if = {
						limit = {
							check_variable = { global.month = 10 }
							
							has_global_flag = EaW_winter_system_on_global_flag
						}
						
						every_country = {
							limit = {
								any_of_scopes = {
									array = controlled_states
									
									check_variable = { EaW_state_winter_grade_var > 3 }
								}
							}
							
							for_each_scope_loop = {
								array = controlled_states
								
								if = {
									limit = {
										check_variable = { EaW_state_winter_grade_var > 3 }
									}
									
									add_to_array = { PREV.EaW_controlled_states_with_winter = THIS }
									
									calculate_EaW_state_winter_debuffer_in_October = yes
								}
							}
							
							country_event = Ntribes.902
						}
					}
					else_if = {
						limit = {
							check_variable = { global.month = 11 }
						}
						
						if = {
							limit = {
								has_global_flag = EaW_winter_system_on_global_flag
							}
							
							every_country = {
								limit = {
									exists = yes
								}
								
								if = {
									limit = {
										has_dynamic_modifier = { modifier = EaW_winter_dynamic_modifier }
									}
									
									prepare_EaW_winter_dynamic_modifier_data_for_recalculation = yes
									
									if = {
										limit = {
											any_of_scopes = {
												array = controlled_states
												
												check_variable = { EaW_state_winter_grade_var = 3 }
											}
										}
										
										for_each_scope_loop = {
											array = controlled_states
											
											if = {
												limit = {
													check_variable = { EaW_state_winter_grade_var = 3 }
												}
												
												add_to_array = { PREV.EaW_controlled_states_with_winter = THIS }
											}
										}
										
										for_each_scope_loop = {
											array = EaW_controlled_states_with_winter
											
											calculate_EaW_state_winter_debuffer_in_November = yes
										}
									}
									else = {
										for_each_scope_loop = {
											array = EaW_controlled_states_with_winter
											
											set_temp_variable = { EaW_state_winter_modifier_temp_var = EaW_state_winter_debuffer_var }
											divide_temp_variable = { EaW_state_winter_modifier_temp_var = 2 } # 0.5/0.4 -> 0.25/0.2
											add_to_variable = { PREV.EaW_country_winter_dynamic_modifier_var = EaW_state_winter_modifier_temp_var }
										}
										
										if = {
											limit = {
												check_variable = { NTR_icebreakers_convoys_reversed_ratio_var > 0.75 }
												check_variable = { EaW_controlled_states_with_winter^num = num_controlled_states } # all 4+
											}
											
											add_EaW_frozen_seas_dynamic_effects = yes
										}
									}
									
									calculate_EaW_winter_dynamic_modifier_effects = yes
								}
								else_if = {
									limit = {
										any_of_scopes = {
											array = controlled_states
											
											check_variable = { EaW_state_winter_grade_var = 3 }
										}
									}
									
									for_each_scope_loop = {
										array = controlled_states
										
										if = {
											limit = {
												check_variable = { EaW_state_winter_grade_var = 3 }
											}
											
											add_to_array = { PREV.EaW_controlled_states_with_winter = THIS }
											
											set_temp_variable = { EaW_state_winter_modifier_temp_var = EaW_state_winter_debuffer_var }
											divide_temp_variable = { EaW_state_winter_modifier_temp_var = 3 } # 0.3 -> 0.1
											add_to_variable = { PREV.EaW_country_winter_dynamic_modifier_var = EaW_state_winter_modifier_temp_var }
										}
									}
									
									country_event = Ntribes.902
								}
							}
						}
						else_if = {
							limit = {
								country_exists = NTR
							}
							
							if = {
								limit = {
									NTR = {
										check_variable = { NTR_icebreakers_convoys_reversed_ratio_var > 0.75 }
										
										NOT = {
											any_of_scopes = {
												array = controlled_states
												
												is_coastal = yes
												is_in_home_area = yes
												
												check_variable = { EaW_state_winter_grade_var < 4 }
											}
										}
									}
								}
								
								NTR = { add_EaW_frozen_seas_dynamic_effects = yes }
							}
							
							if = {
								limit = {
									NTR = { has_civil_war = yes }
								}
								
								random_scope_in_array = {
									array = NTR.enemies
									
									limit = {
										check_variable = { NTR_icebreakers_convoys_reversed_ratio_var > 0.75 }
										
										NOT = {
											any_of_scopes = {
												array = controlled_states
												
												is_coastal = yes
												is_in_home_area = yes
												
												check_variable = { EaW_state_winter_grade_var < 4 }
											}
										}
									}
									
									add_EaW_frozen_seas_dynamic_effects = yes
								}
							}
						}
					}
					else_if = {
						limit = {
							check_variable = { global.month = 12 }
						}
						
						if = {
							limit = {
								has_global_flag = EaW_winter_system_on_global_flag
							}
							
							every_country = {
								limit = {
									exists = yes
								}
								
								if = {
									limit = {
										has_dynamic_modifier = { modifier = EaW_winter_dynamic_modifier }
									}
									
									prepare_EaW_winter_dynamic_modifier_data_for_recalculation = yes
									
									if = {
										limit = {
											any_of_scopes = {
												array = controlled_states
												
												check_variable = { EaW_state_winter_grade_var = 2 }
											}
										}
										
										for_each_scope_loop = {
											array = controlled_states
											
											if = {
												limit = {
													check_variable = { EaW_state_winter_grade_var = 2 }
												}
												
												add_to_array = { PREV.EaW_controlled_states_with_winter = THIS }
											}
										}
										
										for_each_scope_loop = {
											array = EaW_controlled_states_with_winter
											
											calculate_EaW_state_winter_debuffer_in_December = yes
										}
									}
									else = {
										for_each_scope_loop = {
											array = EaW_controlled_states_with_winter
											
											if = {
												limit = {
													check_variable = { EaW_state_winter_grade_var = 3 }
												}
												
												set_temp_variable = { EaW_state_winter_modifier_temp_var = EaW_state_winter_debuffer_var }
												divide_temp_variable = { EaW_state_winter_modifier_temp_var = 1.5 } # 0.3 -> 0.2
												add_to_variable = { PREV.EaW_country_winter_dynamic_modifier_var = EaW_state_winter_modifier_temp_var }
											}
											else = {
												set_temp_variable = { EaW_state_winter_modifier_temp_var = EaW_state_winter_debuffer_var }
												multiply_temp_variable = { EaW_state_winter_modifier_temp_var = 0.75 } # 0.5/0.4 -> 0.375/0.3
												add_to_variable = { PREV.EaW_country_winter_dynamic_modifier_var = EaW_state_winter_modifier_temp_var }
											}
										}
										
										if = {
											limit = {
												check_variable = { NTR_icebreakers_convoys_reversed_ratio_var > 0.5 }
												NOT = { has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier } }
												check_variable = { EaW_controlled_states_with_winter^num = num_controlled_states }
												
												if = {
													limit = {
														check_variable = {
															var = NTR_icebreakers_convoys_reversed_ratio_var
															compare = less_than_or_equals
															value = 0.75
														}
													}
													
													NOT = {
														any_of_scopes = {
															array = controlled_states
															
															is_coastal = yes
															is_in_home_area = yes
															
															check_variable = { EaW_state_winter_grade_var = 3 }
														}
													}
												}
											}
											
											add_EaW_frozen_seas_dynamic_effects = yes
										}
									}
									
									calculate_EaW_winter_dynamic_modifier_effects = yes
								}
								else_if = {
									limit = {
										any_of_scopes = {
											array = controlled_states
											
											check_variable = { EaW_state_winter_grade_var = 2 }
										}
									}
									
									for_each_scope_loop = {
										array = controlled_states
										
										if = {
											limit = {
												check_variable = { EaW_state_winter_grade_var = 2 }
											}
											
											add_to_array = { PREV.EaW_controlled_states_with_winter = THIS }
											
											set_temp_variable = { EaW_state_winter_modifier_temp_var = EaW_state_winter_debuffer_var }
											divide_temp_variable = { EaW_state_winter_modifier_temp_var = 2 } # 0.2 -> 0.1
											add_to_variable = { PREV.EaW_country_winter_dynamic_modifier_var = EaW_state_winter_modifier_temp_var }
										}
									}
									
									country_event = Ntribes.902
								}
							}
						}
						else_if = {
							limit = {
								country_exists = NTR
							}
							
							if = {
								limit = {
									NTR = {
										NOT = { has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier } }
										check_variable = { NTR_icebreakers_convoys_reversed_ratio_var > 0.5 }
										
										if = {
											limit = {
												check_variable = {
													var = NTR_icebreakers_convoys_reversed_ratio_var
													compare = less_than_or_equals
													value = 0.75
												}
											}
											
											NOT = {
												any_of_scopes = {
													array = controlled_states
													
													is_coastal = yes
													is_in_home_area = yes
													
													check_variable = { EaW_state_winter_grade_var < 4 }
												}
											}
										}
										else = {
											NOT = {
												any_of_scopes = {
													array = controlled_states
													
													is_coastal = yes
													is_in_home_area = yes
													
													check_variable = { EaW_state_winter_grade_var < 3 }
												}
											}
										}
									}
								}
								
								NTR = { add_EaW_frozen_seas_dynamic_effects = yes }
							}
							
							if = {
								limit = {
									NTR = { has_civil_war = yes }
								}
								
								random_scope_in_array = {
									array = NTR.enemies
									
									limit = {
										check_variable = { NTR_icebreakers_convoys_reversed_ratio_var > 0.5 }
										NOT = { has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier } }
										
										if = {
											limit = {
												check_variable = {
													var = NTR_icebreakers_convoys_reversed_ratio_var
													compare = less_than_or_equals
													value = 0.75
												}
											}
											
											NOT = {
												any_of_scopes = {
													array = controlled_states
													
													is_coastal = yes
													is_in_home_area = yes
													
													check_variable = { EaW_state_winter_grade_var < 4 }
												}
											}
										}
										else = {
											NOT = {
												any_of_scopes = {
													array = controlled_states
													
													is_coastal = yes
													is_in_home_area = yes
													
													check_variable = { EaW_state_winter_grade_var < 3 }
												}
											}
										}
									}
									
									add_EaW_frozen_seas_dynamic_effects = yes
								}
							}
						}
					}
					else_if = {
						limit = {
							check_variable = { global.month = 1 }
						}
						
						if = {
							limit = {
								has_global_flag = EaW_winter_system_on_global_flag
							}
							
							every_country = {
								limit = {
									exists = yes
								}
								
								if = {
									limit = {
										has_dynamic_modifier = { modifier = EaW_winter_dynamic_modifier }
									}
									
									prepare_EaW_winter_dynamic_modifier_data_for_recalculation = yes
									
									for_each_scope_loop = {
										array = controlled_states
										
										if = {
											limit = {
												check_variable = { EaW_state_winter_grade_var = 1 }
											}
											
											add_to_array = { PREV.EaW_controlled_states_with_winter = THIS }
										}
									}
									
									for_each_scope_loop = {
										array = EaW_controlled_states_with_winter
										
										add_to_variable = { PREV.EaW_country_winter_dynamic_modifier_var = EaW_state_winter_debuffer_var }
									}
									
									if = {
										limit = {
											check_variable = { NTR_icebreakers_convoys_reversed_ratio_var > 0.2 }
											NOT = { has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier } }
											check_variable = { EaW_controlled_states_with_winter^num = num_controlled_states }
											
											if = {
												limit = {
													check_variable = {
														var = NTR_icebreakers_convoys_reversed_ratio_var
														compare = less_than_or_equals
														value = 0.5
													}
												}
												
												NOT = {
													any_of_scopes = {
														array = controlled_states
														
														is_coastal = yes
														is_in_home_area = yes
														
														check_variable = { EaW_state_winter_grade_var < 4 }
													}
												}
											}
											else_if = {
												limit = {
													check_variable = {
														var = NTR_icebreakers_convoys_reversed_ratio_var
														compare = less_than_or_equals
														value = 0.75
													}
												}
												
												NOT = {
													any_of_scopes = {
														array = controlled_states
														
														is_coastal = yes
														is_in_home_area = yes
														
														check_variable = { EaW_state_winter_grade_var < 3 }
													}
												}
											}
										}
										
										add_EaW_frozen_seas_dynamic_effects = yes
									}
									
									calculate_EaW_winter_dynamic_modifier_effects = yes
								}
								else_if = {
									limit = {
										any_of_scopes = {
											array = controlled_states
											
											check_variable = { EaW_state_winter_grade_var = 1 }
										}
									}
									
									for_each_scope_loop = {
										array = controlled_states
										
										if = {
											limit = {
												has_variable = EaW_state_winter_debuffer_var
											}
											
											add_to_array = { PREV.EaW_controlled_states_with_winter = THIS }
											add_to_variable = { PREV.EaW_country_winter_dynamic_modifier_var = EaW_state_winter_debuffer_var }
										}
									}
									
									country_event = Ntribes.902
								}
							}
						}
						else_if = {
							limit = {
								country_exists = NTR
							}
							
							if = {
								limit = {
									NTR = {
										NOT = { has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier } }
										check_variable = { NTR_icebreakers_convoys_reversed_ratio_var > 0.2 }
										
										if = {
											limit = {
												check_variable = {
													var = NTR_icebreakers_convoys_reversed_ratio_var
													compare = less_than_or_equals
													value = 0.5
												}
											}
											
											NOT = {
												any_of_scopes = {
													array = controlled_states
													
													is_coastal = yes
													is_in_home_area = yes
													
													check_variable = { EaW_state_winter_grade_var < 4 }
												}
											}
										}
										else_if = {
											limit = {
												check_variable = {
													var = NTR_icebreakers_convoys_reversed_ratio_var
													compare = less_than_or_equals
													value = 0.75
												}
											}
											
											NOT = {
												any_of_scopes = {
													array = controlled_states
													
													is_coastal = yes
													is_in_home_area = yes
													
													check_variable = { EaW_state_winter_grade_var < 3 }
												}
											}
										}
									}
								}
								
								NTR = { add_EaW_frozen_seas_dynamic_effects = yes }
							}
							
							if = {
								limit = {
									NTR = { has_civil_war = yes }
								}
								
								random_scope_in_array = {
									array = NTR.enemies
									
									limit = {
										check_variable = { NTR_icebreakers_convoys_reversed_ratio_var > 0.2 }
										NOT = { has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier } }
										
										if = {
											limit = {
												check_variable = {
													var = NTR_icebreakers_convoys_reversed_ratio_var
													compare = less_than_or_equals
													value = 0.5
												}
											}
											
											NOT = {
												any_of_scopes = {
													array = controlled_states
													
													is_coastal = yes
													is_in_home_area = yes
													
													check_variable = { EaW_state_winter_grade_var < 4 }
												}
											}
										}
										else_if = {
											limit = {
												check_variable = {
													var = NTR_icebreakers_convoys_reversed_ratio_var
													compare = less_than_or_equals
													value = 0.75
												}
											}
											
											NOT = {
												any_of_scopes = {
													array = controlled_states
													
													is_coastal = yes
													is_in_home_area = yes
													
													check_variable = { EaW_state_winter_grade_var < 3 }
												}
											}
										}
									}
									
									add_EaW_frozen_seas_dynamic_effects = yes
								}
							}
						}
					}
					else_if = {
						limit = {
							check_variable = { global.month = 2 }
						}
						
						if = {
							limit = {
								has_global_flag = EaW_winter_system_on_global_flag
							}
							
							every_country = {
								limit = {
									has_dynamic_modifier = { modifier = EaW_winter_dynamic_modifier }
								}
								
								if = {
									limit = {
										any_of_scopes = {
											array = EaW_controlled_states_with_winter
											
											check_variable = { EaW_state_winter_grade_var > 1 }
										}
									}
									
									prepare_EaW_winter_dynamic_modifier_data_for_recalculation = yes
									
									if = {
										limit = {
											any_of_scopes = {
												array = EaW_controlled_states_with_winter
												
												check_variable = { EaW_state_winter_grade_var = 2 }
											}
										}
										
										for_each_scope_loop = {
											array = EaW_controlled_states_with_winter
											
											if = {
												limit = {
													check_variable = { EaW_state_winter_grade_var > 1 }
												}
												
												calculate_EaW_state_winter_debuffer_in_February = yes
											}
											else = {
												remove_from_array = {
													array = PREV.EaW_controlled_states_with_winter
													value = THIS
												}
											}
										}
										
										if = {
											limit = {
												has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier }
											}
											
											remove_EaW_frozen_seas_effects = yes
										}
									}
									else = {
										for_each_scope_loop = {
											array = EaW_controlled_states_with_winter
											
											if = {
												limit = {
													check_variable = { EaW_state_winter_grade_var > 2 }
												}
												
												if = {
													limit = {
														check_variable = { EaW_state_winter_grade_var = 3 }
													}
													
													set_temp_variable = { EaW_state_winter_modifier_temp_var = EaW_state_winter_debuffer_var }
													divide_temp_variable = { EaW_state_winter_modifier_temp_var = 1.5 } # 0.3 -> 0.2
													add_to_variable = { PREV.EaW_country_winter_dynamic_modifier_var = EaW_state_winter_modifier_temp_var }
												}
												else_if = {
													limit = {
														check_variable = { EaW_state_winter_grade_var = 4 }
													}
													
													set_temp_variable = { EaW_state_winter_modifier_temp_var = EaW_state_winter_debuffer_var }
													multiply_temp_variable = { EaW_state_winter_modifier_temp_var = 0.75 } # 0.4 -> 0.3
													add_to_variable = { PREV.EaW_country_winter_dynamic_modifier_var = EaW_state_winter_modifier_temp_var }
												}
												else = {
													set_temp_variable = { EaW_state_winter_modifier_temp_var = EaW_state_winter_debuffer_var }
													multiply_temp_variable = { EaW_state_winter_modifier_temp_var = 0.8 } # 0.5 -> 0.4
													add_to_variable = { PREV.EaW_country_winter_dynamic_modifier_var = EaW_state_winter_modifier_temp_var }
												}
											}
											else = {
												remove_from_array = {
													array = PREV.EaW_controlled_states_with_winter
													value = THIS
												}
											}
										}
										
										if = {
											limit = {
												has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier }
												
												OR = {
													check_variable = { EaW_controlled_states_with_winter^num < num_controlled_states }
													
													check_variable = {
														var = NTR_icebreakers_convoys_reversed_ratio_var
														compare = less_than_or_equals
														value = 0.4
													}
													
													if = {
														check_variable = {
															var = NTR_icebreakers_convoys_reversed_ratio_var
															compare = less_than_or_equals
															value = 0.75
														}
														
														any_of_scopes = {
															array = EaW_controlled_states_with_winter
															
															is_coastal = yes
															is_in_home_area = yes
															
															check_variable = { EaW_state_winter_grade_var = 3 }
														}
													}
												}
											}
											
											remove_EaW_frozen_seas_effects = yes
										}
									}
									
									calculate_EaW_winter_dynamic_modifier_effects = yes
								}
								else = {
									if = {
										limit = {
											has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier }
										}
										
										remove_EaW_frozen_seas_effects = yes
									}
									
									country_event = Ntribes.903
								}
							}
						}
						else_if = {
							limit = {
								country_exists = NTR
							}
							
							if = {
								limit = {
									NTR = {
										has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier }
										
										OR = {
											check_variable = {
												var = NTR_icebreakers_convoys_reversed_ratio_var
												compare = less_than_or_equals
												value = 0.4
											}
											
											if = {
												check_variable = {
													var = NTR_icebreakers_convoys_reversed_ratio_var
													compare = less_than_or_equals
													value = 0.75
												}
												
												any_of_scopes = {
													array = controlled_states
													
													is_coastal = yes
													is_in_home_area = yes
													
													check_variable = { EaW_state_winter_grade_var = 3 }
												}
											}
										}
									}
								}
								
								NTR = { remove_EaW_frozen_seas_effects = yes }
							}
							
							if = {
								limit = {
									NTR = { has_civil_war = yes }
								}
								
								random_scope_in_array = {
									array = NTR.enemies
									
									limit = {
										has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier }
										
										OR = {
											check_variable = {
												var = NTR_icebreakers_convoys_reversed_ratio_var
												compare = less_than_or_equals
												value = 0.4
											}
											
											if = {
												check_variable = {
													var = NTR_icebreakers_convoys_reversed_ratio_var
													compare = less_than_or_equals
													value = 0.8
												}
												
												any_of_scopes = {
													array = controlled_states
													
													is_coastal = yes
													is_in_home_area = yes
													
													check_variable = { EaW_state_winter_grade_var = 3 }
												}
											}
										}
									}
									
									remove_EaW_frozen_seas_effects = yes
								}
							}
						}
					}
					else_if = {
						limit = {
							check_variable = { global.month = 3 }
						}
						
						if = {
							limit = {
								has_global_flag = EaW_winter_system_on_global_flag
							}
							
							every_country = {
								limit = {
									has_dynamic_modifier = { modifier = EaW_winter_dynamic_modifier }
								}
								
								if = {
									limit = {
										any_of_scopes = {
											array = EaW_controlled_states_with_winter
											
											check_variable = { EaW_state_winter_grade_var > 2 }
										}
									}
									
									prepare_EaW_winter_dynamic_modifier_data_for_recalculation = yes
									
									if = {
										limit = {
											any_of_scopes = {
												array = EaW_controlled_states_with_winter
												
												check_variable = { EaW_state_winter_grade_var = 3 }
											}
										}
										
										for_each_scope_loop = {
											array = EaW_controlled_states_with_winter
											
											if = {
												limit = {
													check_variable = { EaW_state_winter_grade_var > 2 }
												}
												
												calculate_EaW_state_winter_debuffer_in_March = yes
											}
											else = {
												remove_from_array = {
													array = PREV.EaW_controlled_states_with_winter
													value = THIS
												}
											}
										}
										
										if = {
											limit = {
												has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier }
											}
											
											remove_EaW_frozen_seas_effects = yes
										}
									}
									else = {
										for_each_scope_loop = {
											array = EaW_controlled_states_with_winter
											
											if = {
												limit = {
													check_variable = { EaW_state_winter_grade_var > 3 }
												}
												
												if = {
													limit = {
														check_variable = { EaW_state_winter_grade_var = 4 }
													}
													
													set_temp_variable = { EaW_state_winter_modifier_temp_var = EaW_state_winter_debuffer_var }
													divide_temp_variable = { EaW_state_winter_modifier_temp_var = 2 } # 0.4 -> 0.2
													add_to_variable = { PREV.EaW_country_winter_dynamic_modifier_var = EaW_state_winter_modifier_temp_var }
												}
												else = {
													set_temp_variable = { EaW_state_winter_modifier_temp_var = EaW_state_winter_debuffer_var }
													multiply_temp_variable = { EaW_state_winter_modifier_temp_var = 0.6 } # 0.5 -> 0.3
													add_to_variable = { PREV.EaW_country_winter_dynamic_modifier_var = EaW_state_winter_modifier_temp_var }
												}
											}
											else = {
												remove_from_array = {
													array = PREV.EaW_controlled_states_with_winter
													value = THIS
												}
											}
										}
										
										if = {
											limit = {
												has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier }
												
												OR = {
													check_variable = { EaW_controlled_states_with_winter^num < num_controlled_states }
													
													check_variable = {
														var = NTR_icebreakers_convoys_reversed_ratio_var
														compare = less_than_or_equals
														value = 0.6
													}
												}
											}
											
											remove_EaW_frozen_seas_effects = yes
										}
									}
									
									calculate_EaW_winter_dynamic_modifier_effects = yes
								}
								else = {
									if = {
										limit = {
											has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier }
										}
										
										remove_EaW_frozen_seas_effects = yes
									}
									
									country_event = Ntribes.903
								}
							}
						}
						else_if = {
							limit = {
								country_exists = NTR
							}
							
							if = {
								limit = {
									NTR = {
										has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier }
										
										OR = {
											check_variable = {
												var = NTR_icebreakers_convoys_reversed_ratio_var
												compare = less_than_or_equals
												value = 0.6
											}
										}
									}
								}
								
								NTR = { remove_EaW_frozen_seas_effects = yes }
							}
							
							if = {
								limit = {
									NTR = { has_civil_war = yes }
								}
								
								random_scope_in_array = {
									array = NTR.enemies
									
									limit = {
										has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier }
										
										OR = {
											check_variable = {
												var = NTR_icebreakers_convoys_reversed_ratio_var
												compare = less_than_or_equals
												value = 0.6
											}
										}
									}
									
									remove_EaW_frozen_seas_effects = yes
								}
							}
						}
					}
					else_if = {
						limit = {
							check_variable = { global.month = 4 }
						}
						
						if = {
							limit = {
								has_global_flag = EaW_winter_system_on_global_flag
							}
							
							every_country = {
								limit = {
									has_dynamic_modifier = { modifier = EaW_winter_dynamic_modifier }
								}
								
								if = {
									limit = {
										any_of_scopes = {
											array = EaW_controlled_states_with_winter
											
											check_variable = { EaW_state_winter_grade_var > 3 }
										}
									}
									
									prepare_EaW_winter_dynamic_modifier_data_for_recalculation = yes
									
									if = {
										limit = {
											any_of_scopes = {
												array = EaW_controlled_states_with_winter
												
												check_variable = { EaW_state_winter_grade_var = 4 }
											}
										}
										
										for_each_scope_loop = {
											array = EaW_controlled_states_with_winter
											
											if = {
												limit = {
													check_variable = { EaW_state_winter_grade_var > 3 }
												}
												
												calculate_EaW_state_winter_debuffer_in_April = yes
											}
											else = {
												remove_from_array = {
													array = PREV.EaW_controlled_states_with_winter
													value = THIS
												}
											}
										}
										
										if = {
											limit = {
												has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier }
											}
											
											remove_EaW_frozen_seas_effects = yes
										}
									}
									else = {
										for_each_scope_loop = {
											array = EaW_controlled_states_with_winter
											
											set_temp_variable = { EaW_state_winter_modifier_temp_var = EaW_state_winter_debuffer_var }
											multiply_temp_variable = { EaW_state_winter_modifier_temp_var = 0.4 } # 0.5 -> 0.2
											add_to_variable = { PREV.EaW_country_winter_dynamic_modifier_var = EaW_state_winter_modifier_temp_var }
										}
										
										if = {
											limit = {
												has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier }
												
												OR = {
													check_variable = { EaW_controlled_states_with_winter^num < num_controlled_states }
													
													check_variable = {
														var = NTR_icebreakers_convoys_reversed_ratio_var
														compare = less_than_or_equals
														value = 0.8
													}
												}
											}
											
											remove_EaW_frozen_seas_effects = yes
										}
									}
									
									calculate_EaW_winter_dynamic_modifier_effects = yes
								}
								else = {
									if = {
										limit = {
											has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier }
										}
										
										remove_EaW_frozen_seas_effects = yes
									}
									
									country_event = Ntribes.903
								}
							}
						}
						else_if = {
							limit = {
								country_exists = NTR
							}
							
							if = {
								limit = {
									NTR = {
										has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier }
										
										check_variable = {
											var = NTR_icebreakers_convoys_reversed_ratio_var
											compare = less_than_or_equals
											value = 0.8
										}
									}
								}
								
								NTR = { remove_EaW_frozen_seas_effects = yes }
							}
							
							if = {
								limit = {
									NTR = { has_civil_war = yes }
								}
								
								random_scope_in_array = {
									array = NTR.enemies
									
									limit = {
										has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier }
										
										check_variable = {
											var = NTR_icebreakers_convoys_reversed_ratio_var
											compare = less_than_or_equals
											value = 0.8
										}
									}
									
									remove_EaW_frozen_seas_effects = yes
								}
							}
						}
					}
					else_if = {
						limit = {
							check_variable = { global.month = 5 }
						}
						
						if = {
							limit = {
								has_global_flag = EaW_winter_system_on_global_flag
							}
							
							every_country = {
								limit = {
									has_dynamic_modifier = { modifier = EaW_winter_dynamic_modifier }
								}
								
								if = {
									limit = {
										any_of_scopes = {
											array = EaW_controlled_states_with_winter
											
											check_variable = { EaW_state_winter_grade_var = 5 }
										}
									}
									
									prepare_EaW_winter_dynamic_modifier_data_for_recalculation = yes
									
									for_each_scope_loop = {
										array = EaW_controlled_states_with_winter
										
										if = {
											limit = {
												check_variable = { EaW_state_winter_grade_var = 5 }
											}
											
											calculate_EaW_state_winter_debuffer_in_May = yes
										}
										else = {
											remove_from_array = {
												array = PREV.EaW_controlled_states_with_winter
												value = THIS
											}
										}
									}
									
									calculate_EaW_winter_dynamic_modifier_effects = yes
								}
								else = {
									country_event = Ntribes.903
								}
							}
						}
						
						if = {
							limit = {
								country_exists = NTR
							}
							
							if = {
								limit = {
									NTR = { has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier } }
								}
								
								NTR = { remove_EaW_frozen_seas_effects = yes }
							}
							
							if = {
								limit = {
									NTR = { has_civil_war = yes }
								}
								
								random_scope_in_array = {
									array = NTR.enemies
									
									limit = {
										has_dynamic_modifier = { modifier = EaW_frozen_seas_dynamic_modifier }
									}
									
									remove_EaW_frozen_seas_effects = yes
								}
							}
						}
					}
					else = {
						if = {
							limit = {
								has_global_flag = EaW_winter_system_on_global_flag
							}
							
							every_country = {
								limit = {
									has_dynamic_modifier = { modifier = EaW_winter_dynamic_modifier }
								}
								
								country_event = Ntribes.903
							}
						}
					}
				}
			}
		}
	}
}