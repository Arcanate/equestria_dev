###########################
# Maregypt Events
###########################

add_namespace = mgy

##SOMNAMBULA SERIES - Somnambula tries to figure out modernity, getting swayed politically in the process
 country_event = {
	 id = mgy.1##Somnambula goes to visit R'ataphet on a public goodwill tour
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.1"}#Auto-logging
	 title = mgy.1.t
	 desc = mgy.1.d

	 fire_only_once = yes
	
	 is_triggered_only = yes

	
	option = { #Send her through the central street - can lead to her gaining Communist sympathy points
		 name = mgy.1.a
		 hidden_effect = {
			country_event = {id = mgy.2 days = 9 random = 48}				
			country_event = { id = mgy.4 days = 45 random = 48 }
	     }
	 }
	 option = { # Keep her confined to dining with dignitaries - she won't see the plight of the commonfolk but might get swayed by some Neutrals
		 name = mgy.1.b
		 hidden_effect = {
		   country_event = {id = mgy.3 days = 9 random = 48}				
		   country_event = { id = mgy.4 days = 45 random = 48 }
		}
		#ai_chance = { ##don't actually want an ai_chance for this event but I do want to have the code format on hand
		#	 base = 0
		#}
	 }
	 option = {#Cancel the trip - but she won't like this
		name = mgy.1.c
			add_political_power = -50
			add_to_variable = { var = somnAnger value = 1 }
			custom_effect_tooltip = MGY_get_angry
			hidden_effect = {
				country_event = { id = mgy.4 days = 45 random = 48 }			
			}
	 }
 }
 
 country_event = {
	 id = mgy.2##Somnambula sees the cheering masses and is inspired 
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.2"}#Auto-logging
	 title = mgy.2.t
	 desc = mgy.2.d

	 fire_only_once = yes
	
	 is_triggered_only = yes

	
	option = { #She gives a speech to the ponies
		 name = mgy.2.a
			add_stability = 0.01
			add_to_variable = { var = somnHarmony value = 1 }
			custom_effect_tooltip = MGY_somn_get_harmony
	}
	option = { #She insists on going in to see the slumdwellers
		 name = mgy.2.b
			add_stability = -0.01
			add_to_variable = { var = somnCommunism value = 1 }
			custom_effect_tooltip = MGY_somn_get_communism
	}
	option = { #Refuse to allow her to go, for safety concerns
		name = mgy.2.c
			add_political_power = -100
			custom_effect_tooltip = MGY_get_angry
			add_to_variable = { var = somnAnger value = 1 }
	}
 }
 country_event = {
	 id = mgy.3##Somnambula spends the day dining with rich dignitaries, and is impressed with how far technology has come
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.3"}#Auto-logging
	 title = mgy.3.t
	 desc = mgy.3.d

	 fire_only_once = yes
	
	 is_triggered_only = yes

	
	option = { #She meets the distant descendants of some nobles she knew and regales them with tales of their ancestors
		 name = mgy.3.a
		 add_stability = 0.01
		 custom_effect_tooltip = MGY_somn_get_neutrality
		 add_to_variable = { var = somnNeutrality value = 1 }
	}
	option = { #She is wowed by modern, Equestrian technology
		name = mgy.3.b
			custom_effect_tooltip = MGY_somn_get_harmony
			add_to_variable = { var = somnHarmony value = 1 }
	}
 }

 country_event = {
	 id = mgy.4##Second Somnambula event - she goes on a trip to Maneisrata, but who knows what she will support...
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.4"}#Auto-logging
	 title = mgy.4.t
	 desc = mgy.4.d

	 fire_only_once = yes
	
	 is_triggered_only = yes

	
	option = { #She praises the Manedalusian culture, and their ability to work together
		 name = mgy.4.a
			custom_effect_tooltip = MGY_somn_get_harmony
			add_to_variable = { var = somnHarmony value = 1 }
			hidden_effect = {
				country_event = { id = mgy.5 days = 45 random = 48 }
			}
	}
	option = { #She casually states that mgy used to own land in ABY even in her day, a fact widely known in her day but in the modern day doubted by most except for Maregyptian nationalists. This is taken as support for ARM
		name = mgy.4.b
			custom_effect_tooltip = MGY_somn_get_fascism
			add_to_variable = { var = somnFascism value = 1 }
			hidden_effect = {
				country_event = { id = mgy.5 days = 45 random = 48 }
			}
	}
	option = { #She's unpredictable, what if she says something that makes things worse? Shut down the event.
		name = mgy.4.c
			custom_effect_tooltip = MGY_get_angry
			add_to_variable = { var = somnAnger value = 1 }
			hidden_effect = {
				country_event = { id = mgy.5 days = 45 random = 48 }
			}
	}
 }
 country_event = {
	 id = mgy.5##Third Somnambula event - she goes to ARM HQ to figure out what their deal is
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.5"}#Auto-logging
	 title = mgy.5.t
	 desc = mgy.5.d

	 fire_only_once = yes
	
	 is_triggered_only = yes

	
	option = { #Prince Shepser reminds her of old Hisan
		 name = mgy.5.a
			custom_effect_tooltip = MGY_somn_get_neutrality
			add_to_variable = { var = somnNeutrality value = 1 }
			hidden_effect = {
				country_event = { id = mgy.6 days = 45 random = 48 }
			}
	}
	option = { #She is impressed by the DRP leader's eloquence
		name = mgy.5.b
			custom_effect_tooltip = MGY_somn_get_fascism
			add_to_variable = { var = somnFascism value = 1 }
			hidden_effect = {
				country_event = { id = mgy.6 days = 45 random = 48 }
			}
	}
	option = { #Stop her from attending
		 name = mgy.5.c
			custom_effect_tooltip = MGY_get_angry
			add_to_variable = { var = somnAnger value = 1 }
			hidden_effect = {
				country_event = { id = mgy.6 days = 45 random = 48 }
				if = {
					limit = {
						check_variable = { somnAnger > 2 }##if you've stopped her three times
					}
					country_event = { id = mgy.9 days = 180 random = 24 }
				}
			}
	}
 }
 country_event = {
	 id = mgy.6##Fourth Somnambula event - she goes undercover in the marketplace, and stumbles across a strike
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.6"}#Auto-logging
	 title = mgy.6.t
	 desc = mgy.6.d

	 fire_only_once = yes
	 trigger = {
		has_idea = mgy_somnambula
	 }
	 is_triggered_only = yes

	
	option = { #She sympathises with the common folk
		 name = mgy.6.a
			custom_effect_tooltip = MGY_somn_get_communism
			add_to_variable = { var = somnCommunism value = 1 }
			hidden_effect = {
				country_event = { id = mgy.7 days = 45 random = 48 }			
			}
	}
	option = { #She is outraged by their blithe verbal abuse of the King
		name = mgy.6.b
			custom_effect_tooltip = MGY_somn_get_neutrality
			add_to_variable = { var = somnNeutrality value = 1 }
			hidden_effect = {
				country_event = { id = mgy.7 days = 45 random = 48 }			
			}
	}
 }
 country_event = {
	 id = mgy.7##Fifth Somnambula event - she follows a long-running dispute in academic literature about the merits of Republicanism vs Communism
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.7"}#Auto-logging
	 title = mgy.7.t
	 desc = mgy.7.d
	 fire_only_once = yes
	 trigger = {
		has_idea = mgy_somnambula
	 }	
	 is_triggered_only = yes

	
	option = { #She muses that the commonfolk often knew their business better than the Pharaoh did
		 name = mgy.7.a
			custom_effect_tooltip = MGY_somn_get_fascism
			add_to_variable = { var = somnFascism value = 1 }
			hidden_effect = {
				country_event = { id = mgy.8 days = 45 random = 48 }			
			}
	}
	option = { #She remembers the cringing slaves that used to support the Old Kingdom, and weeps for them
		name = mgy.7.b
			custom_effect_tooltip = MGY_somn_get_communism
			add_to_variable = { var = somnCommunism value = 1 }
			hidden_effect = {
				country_event = { id = mgy.8 days = 45 random = 48 }			
			}
	}
	option = { #She muses that both of them are ivory-tower scholars who know nothing about the plight on the ground
		name = mgy.7.c
			hidden_effect = {
				country_event = { id = mgy.8 days = 45 random = 48 }			
			}
	}
 }
 country_event = {
	 id = mgy.8##Sixth Somnambula event - she goes to a major public debate
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.8"}#Auto-logging
	 title = mgy.8.t
	 desc = mgy.8.d

	 fire_only_once = yes
	 trigger = {
		has_idea = mgy_somnambula
	 }	
	 is_triggered_only = yes

	
	option = { #She is convinced by the KM speaker
		 name = mgy.8.a
			custom_effect_tooltip = MGY_somn_get_harmony
			add_to_variable = { var = somnHarmony value = 1 }
			if = {
				limit = {
					has_idea = MGY_somnambula##If Sommie is going to quit she should've done so by now
				}
				country_event = { id = mgy.10}
			}
	}
	option = { #She sympathises with the LPMG speaker
		name = mgy.8.b
			custom_effect_tooltip = MGY_somn_get_communism
			add_to_variable = { var = somnCommunism value = 1 }
			if = {
				limit = {
					has_idea = MGY_somnambula##If Sommie is going to quit she should've done so by now
				}
				country_event = { id = mgy.10}
			}
	}
	option = { #She naturally feels at ease with the Pharaonist idea
		name = mgy.8.c
			custom_effect_tooltip = mgy_somn_get_neutrality
			add_to_variable = { var = somnNeutrality value = 1 }
			if = {
				limit = {
					has_idea = MGY_somnambula##If Sommie is going to quit she should've done so by now
				}
				country_event = { id = mgy.10}
			}
	}
	option = { #She considers that Republicanism might be worth a try after all
		name = mgy.8.d
			custom_effect_tooltip = mgy_somn_get_fascism
			add_to_variable = { var = somnFascism value = 1 }
			if = {
				limit = {
					has_idea = MGY_somnambula##If Sommie is going to quit she should've done so by now
				}
				country_event = { id = mgy.10}
			}
	}
 }
 country_event = {
	 id = mgy.9##Somnambula storms out if her anger is above a certain level
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.9"}#Auto-logging
	 title = mgy.9.t
	 desc = mgy.9.d

	 fire_only_once = yes
	
	 is_triggered_only = yes

	
	option = { #Somnambula goes into hiding and refuses to cooperate with the government anymore
		 name = mgy.9.a
			remove_ideas = MGY_somnambula
			set_country_flag = MGY_som_gone
	}

 }
 country_event = {
	 id = mgy.10##Somnambula makes her pronouncement of support
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.10"}#Auto-logging
	 title = mgy.10.t
	 desc = mgy.10.d

	 fire_only_once = yes
	
	 is_triggered_only = yes

	
	option = {#Harmony
		 name = mgy.10.a
	     trigger = {
			check_variable = { somnHarmony > somnCommunism }
			check_variable = { somnHarmony > somnNeutrality }
			check_variable = { somnHarmony > somnFascism }
		 }
		 add_popularity = {
			ideology = democratic popularity = 0.15
		 }
	}
	option = {#Communism
		 name = mgy.10.b
	     trigger = {
			check_variable = { somnCommunism > somnHarmony }
			check_variable = { somnCommunism > somnNeutrality }
			check_variable = { somnCommunism > somnFascism }
		 }
		 add_popularity = {
			ideology = communism popularity = 0.15
		 }
	}
	option = {#Neutrality
		 name = mgy.10.c
	     trigger = {
			check_variable = { somnNeutrality > somnHarmony }
			check_variable = { somnNeutrality > somnCommunism}
			check_variable = { somnNeutrality > somnFascism }
		 }
		 add_popularity = {
			ideology = neutrality popularity = 0.15
		 }
	}
	option = {#Fascism
		 name = mgy.10.d
	     trigger = {
			check_variable = { somnFascism > somnHarmony }
			check_variable = { somnFascism > somnCommunism}
			check_variable = { somnFascism > somnNeutrality }
		 }
		 add_popularity = {
			ideology = fascism popularity = 0.15
		 }
	}

 }
 country_event = {
	 id = mgy.11##Public debate on the merits of going to war with Abyssinia now vs later or never
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.11"}#Auto-logging
	 title = mgy.11.t
	 desc = mgy.11.d

	 fire_only_once = yes
	
	 is_triggered_only = yes

	
	option = {#War
		 name = mgy.11.a
		 add_popularity = {
			ideology = neutrality popularity = 0.03
		 }
		 add_popularity = {
			ideology = neutrality popularity = 0.03
		 }
		 add_war_support = 0.05
	}
	option = {#Words
		 name = mgy.11.b
		 add_popularity = {
			ideology = democratic popularity = 0.05
		 }
		 add_war_support = -0.05
	}

 }
 country_event = {
	 id = mgy.12##Equestria informed of MGY nationalising some Equestrian-owned businesses
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.12"}#Auto-logging
	 title = mgy.12.t
	 desc = mgy.12.d

	 fire_only_once = yes
	
	 is_triggered_only = yes

	

	option = {#Cut our economic assistance entirely!
		 name = mgy.12.a
		 FROM = {
			country_event = { id = mgy.13 }
		 }
	}
	option = {#Reduce our economic assistance
		 name = mgy.12.b
		 add_stability = -0.025
		 add_political_power = -25
		 FROM = {
			country_event = { id = mgy.14 }
		 }
	}
	option = {#Forgive them, they must have a good reason
		 name = mgy.12.c
		 add_stability = -0.05
		 add_political_power = -50
		 FROM = {
			country_event = { id = mgy.15 }
		 }
	}

 }
 country_event = {
	 id = mgy.13##MGY informed that they've had their economic aid cut
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.13"}#Auto-logging
	 title = mgy.13.t
	 desc = mgy.13.d

	 fire_only_once = yes
	
	 is_triggered_only = yes

	
	option = {#Oof
		 name = mgy.12.a
		 remove_ideas = MGY_EQS_influence
	}
 }
 country_event = {
	 id = mgy.14##MGY informed that they've had their economic aid reduced
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.14"}#Auto-logging
	 title = mgy.14.t
	 desc = mgy.14.d

	 fire_only_once = yes
	
	 is_triggered_only = yes

	
	option = {#Ooof
		 name = mgy.14.a
		 swap_ideas = {
			remove_idea = MGY_EQS_influence add_idea = MGY_EQS_influence_reduced
		 }
	}
 }
 country_event = {
	 id = mgy.15##MGY informed that they've gotten away with it
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.15"}#Auto-logging
	 title = mgy.15.t
	 desc = mgy.15.d

	 fire_only_once = yes
	
	 is_triggered_only = yes

	
	option = {#Phew
		 name = mgy.15.a
	}
 }
  country_event = {
	 id = mgy.16##MGY-Ovambo peace talks
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.16"}#Auto-logging
	 title = mgy.16.t
	 desc = mgy.16.d

	 fire_only_once = yes
	
	 is_triggered_only = yes

	
	option = {#Good
		 name = mgy.16.a
		 set_country_flag = MGY_ovambo_talks_happened
		 custom_effect_tooltip = MGY_ovambo_revolt_delayed
	}
 }
  country_event = {
	 id = mgy.90##Ideology swinging test event
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.90"}#Auto-logging
	 title = mgy.90.t
	 desc = mgy.90.d

	 fire_only_once = yes
	
	 is_triggered_only = yes

	
	option = {#Good
		 name = mgy.90.a
		 add_popularity = {
			ideology = neutrality
			popularity = 0.25
		 }
		 add_popularity = {
			ideology = fascism
			popularity = 0.25
		 }
		set_variable = { var = ARMPop value = 0 }
		add_to_variable = { var = ARMPop value = party_popularity@neutrality }
		add_to_variable = { var = ARMPop value = party_popularity@fascism }
	}
 }
  country_event = {
	 id = mgy.17##Filler event to allow ARMPop to be set before the election happens proper
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.17"}#Auto-logging
	 title = mgy.17.t
	 desc = mgy.17.d

	 fire_only_once = yes
	
	 is_triggered_only = yes

	
	option = {#It is time
		 name = mgy.17.a
			set_variable = { var = ARMPop value = 0 }
			add_to_variable = { var = ARMPop value = party_popularity@neutrality }
			add_to_variable = { var = ARMPop value = party_popularity@fascism }
			country_event = {
				id = mgy.18
			}
	}
 }
  country_event = {
	 id = mgy.18##The election proper
	 immediate = {log = "[GetDateText]: [Root.GetName]: event mgy.18"}#Auto-logging
	 title = mgy.18.t
	 desc = mgy.18.d

	 fire_only_once = yes
	
	 is_triggered_only = yes

	option = {#the result
		name = mgy.18.a
		 if = {
			limit = {
				AND = {
					check_variable = { party_popularity@democratic > party_popularity@communism }					
					check_variable = { party_popularity@democratic > party_popularity@neutrality }					
					check_variable = { party_popularity@democratic > party_popularity@fascism }					
				}
			}
			add_popularity = {
				ideology = democratic
				popularity = 0.25
			}
		 }
		 else_if = {
			limit = {
				AND = {
					check_variable = { party_popularity@communism > party_popularity@democratic }					
					check_variable = { party_popularity@communism > party_popularity@neutrality }					
					check_variable = { party_popularity@communism > party_popularity@fascism }					
				}
			}
			set_politics = {
				ruling_party = communism
				elections_allowed = no
			}
			add_popularity = {
				ideology = communism
				popularity = 0.15
			}
		 }
		 else_if = {
			limit = {###The ARM wins, but they both gain the same popularity
				AND = {
					check_variable = { ARMPop > party_popularity@democratic }					
					check_variable = { ARMPop > party_popularity@communism }					
				}
			}
			set_politics = {
				ruling_party = neutrality
				elections_allowed = no
			}
			add_popularity = {
				ideology = neutrality
				popularity = 0.10
			}
			add_popularity = {
				ideology = fascism
				popularity = 0.10
			}
		 }
	}
 }