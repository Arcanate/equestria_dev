add_namespace = brodfeld_rework

#start private functions

#to do: recursive_improve_society (mtth hidden event improves society by one step every 145 days. calls itself intill max society reached

#end private functions

#start public events


country_event = 
{
	id = brodfeld_rework.1 #focus army the unemployed
	title = brodfeld_rework.1.t
	desc = brodfeld_rework.1.d
	picture = GFX_event_griffon_mountain
	is_triggered_only = yes
	option = 
	{
		name = brodfeld_rework.1.a
		custom_effect_tooltip = brodfeld_rework.1.b
		hidden_effect = 
		{		
			add_war_support = 0.1
			division_template = 
			{
				name = "Brodfeld's Unemployed"
				priority = 0
				regiments = 
				{
					infantry = { x = 0 y = 0 }
					infantry = { x = 0 y = 1 }
					infantry = { x = 0 y = 2 }
				}
			}
			508 = 
			{
				#limit = { ROOT = { has_full_control_of_state = PREV } } #to decide wether to limit it and how later
				create_unit = 
				{
					division = "name = \"Brodfeld's Unemployed\" division_template = \"Brodfeld's Unemployed\" start_experience_factor = 0.1" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Unemployed\" division_template = \"Brodfeld's Unemployed\" start_experience_factor = 0.1" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Unemployed\" division_template = \"Brodfeld's Unemployed\" start_experience_factor = 0.1" 
					owner = ROOT
				}
			}
		}
	}
}

country_event = 
{
	id = brodfeld_rework.2 #focus army the workers
	title = brodfeld_rework.2.t
	desc = brodfeld_rework.2.d
	picture = GFX_event_griffon_mountain
	is_triggered_only = yes
	option = 
	{
		name = brodfeld_rework.2.a
		custom_effect_tooltip = brodfeld_rework.2.b
		hidden_effect = 
		{		
			add_war_support = 0.15
			division_template = 
			{
				name = "Brodfeld's Workers"
				priority = 0
				regiments = 
				{
					infantry = { x = 0 y = 0 }
					infantry = { x = 0 y = 1 }
					infantry = { x = 0 y = 2 }
				}
			}
			508 = 
			{
				#limit = { ROOT = { has_full_control_of_state = PREV } } #to decide wether to limit it and how later
				create_unit = 
				{
					division = "name = \"Brodfeld's Workers\" division_template = \"Brodfeld's Workers\" start_experience_factor = 0.1" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Workers\" division_template = \"Brodfeld's Workers\" start_experience_factor = 0.1" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Workers\" division_template = \"Brodfeld's Workers\" start_experience_factor = 0.1" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Workers\" division_template = \"Brodfeld's Workers\" start_experience_factor = 0.1" 
					owner = ROOT
				}
			}
		}
	}
}

country_event = 
{
	id = brodfeld_rework.3 #focus army the workers
	title = brodfeld_rework.3.t
	desc = brodfeld_rework.3.d
	is_triggered_only = yes
	option = 
	{
		name = brodfeld_rework.3.a
		custom_effect_tooltip = brodfeld_rework.3.b
		hidden_effect = 
		{		
			add_war_support = 0.15
			division_template = 
			{
				name = "Brodfeld's Civilians"
				priority = 0
				regiments = 
				{
					infantry = { x = 0 y = 0 }
					infantry = { x = 0 y = 1 }
					infantry = { x = 0 y = 2 }
					infantry = { x = 1 y = 0 }
					infantry = { x = 1 y = 1 }
					infantry = { x = 1 y = 2 }
				}
			}
			508 = 
			{
				#limit = { ROOT = { has_full_control_of_state = PREV } } #to decide wether to limit it and how later
				create_unit = 
				{
					division = "name = \"Brodfeld's Civilians\" division_template = \"Brodfeld's Civilians\" start_experience_factor = 0.0" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Civilians\" division_template = \"Brodfeld's Civilians\" start_experience_factor = 0.0" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Civilians\" division_template = \"Brodfeld's Civilians\" start_experience_factor = 0.0" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Civilians\" division_template = \"Brodfeld's Civilians\" start_experience_factor = 0.0" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Civilians\" division_template = \"Brodfeld's Civilians\" start_experience_factor = 0.0" 
					owner = ROOT
				}
			}
		}
	}
}

country_event = 
{
	id = brodfeld_rework.4 #focus a deep plan #dbg works
	title = brodfeld_rework.4.t
	desc = brodfeld_rework.4.d
	picture = GFX_event_griffon_mountain
	is_triggered_only = yes
	option = 
	{
		name = brodfeld_rework.4.a
		custom_effect_tooltip = brodfeld_rework.4.b
		add_ideas = BRF_deep_plan
		set_country_flag = BRF_deep_plan_started
		
	}
}

country_event = 
{
	id = brodfeld_rework.5 #deep plan reward #dbg works
	#title = brodfeld_rework.5.t
	title = "dbg end plan success"
	desc = brodfeld_rework.5.d
	picture = GFX_event_griffon_mountain
	trigger = #start counting 30 days from the appearance of this idea (finishing the deep plan focus)
	{
		has_idea = BRF_deep_plan
	}
	#available = #stop mtth wait if port was lost
	#{
	#	has_idea = BRF_deep_plan
	#}
	#allowed = 
	#{
	#	always = no
	#}
	mean_time_to_happen = 
	{
		days = 30 
	}
	fire_only_once = yes
	option = #sucess
	{
		name = brodfeld_rework.5.a
		custom_effect_tooltip = brodfeld_rework.5.b
		#cont adding the quest reward here
		
		
		set_country_flag = BRF_deep_plan_finished
		remove_ideas = BRF_deep_plan
	}
}

country_event = #dbg dont work. dont get called
{
	id = brodfeld_rework.6 #deep plan fail
	#title = brodfeld_rework.6.t
	title = "dbg end plan fail"
	desc = brodfeld_rework.6.d
	picture = GFX_event_griffon_mountain
	#trigger = 
	#{
		#has_country_flag = BRF_deep_plan_started
		##AND
		#NOT { has_idea = BRF_deep_plan }
		#NOT { controls_state = 385 } crashes
	#}
	available = #dont show after idea removed if quest completed
	{
		has_country_flag = BRF_deep_plan_started
		#AND
		NOT { has_country_flag = BRF_deep_plan_finished }
	}
	allowed = 
	{
		always = no
	}
	is_triggered_only = yes #trying on removal idea approcah
	fire_only_once = yes 
	option = #failed
	{
		name = brodfeld_rework.6.a
		custom_effect_tooltip = brodfeld_rework.6.b
	}
}



#end public events

#include in the spawning code:
#NOT = { has_country_flag = BRF_already spawned }
#then, in the part that spawns the troops, right at the end
#set_country_flag = BRF_already_spawned


#option = {
#        name = falcor.1.a
#        custom_effect_tooltip = FLA_form_militias_tt
#        hidden_effect = { load_oob = FAL_Militias }
#    }

#trigger = {
#	AND = {
#		NOT = { has_country_flag = pakistani_question }
#		tag = RAJ
#		GRE = { owns_state = 440 }
#		GRE = { owns_state = 441 }
#		GRE = { owns_state = 442 }
#		GRE = { owns_state = 443 }
#		GRE = { owns_state = 444 }
#		GRE = { owns_state = 445 }
#	}
#}
#
#mean_time_to_happen = {
#	days = 1
#}
#
#option = {
#	ai_chance = {
#		factor = 100
#	}
#	name = persia.10.a
#		GRE = { 
#			country_event = { hours = 6 id = persia.11 }
#		}
#	set_country_flag = pakistani_question
#}

#option = {
#	ai_chance = {
#		factor = 0
#	}
#	name = persia.10.b
#	set_country_flag = pakistani_question
#}
#}
















