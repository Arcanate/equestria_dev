add_namespace = brodfeld_rework

#start private functions

#to do: recursive_improve_society (mtth hidden event improves society by one step every 145 days. calls itself intill max society reached

#end private functions

#start public events


country_event =  #adding starting_equipment_factor to the strings. if something broke, delete this and restore to     division = "name = \"Brodfeld's Unemployed\" division_template = \"Brodfeld's Unemployed\" start_experience_factor = 0.1" 
{
	id = brodfeld_rework.1 #focus army the unemployed
	title = brodfeld_rework.1.t
	desc = brodfeld_rework.1.d
	picture = GFX_event_griffon_mountain
	is_triggered_only = yes
	option = 
	{
		name = brodfeld_rework.1.a
		custom_effect_tooltip = brodfeld_rework.1.b
		hidden_effect = 
		{		
			add_war_support = 0.1
			division_template = 
			{
				name = "Brodfeld's Unemployed"
				priority = 0
				regiments = 
				{
					infantry = { x = 0 y = 0 }
					infantry = { x = 0 y = 1 }
					infantry = { x = 0 y = 2 }
				}
			}
			508 = 
			{
				#limit = { ROOT = { has_full_control_of_state = PREV } } #to decide wether to limit it and how later
				create_unit = 
				{
					division = "name = \"Brodfeld's Unemployed\" division_template = \"Brodfeld's Unemployed\" start_experience_factor = 0.1 start_equipment_factor = 0.5" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Unemployed\" division_template = \"Brodfeld's Unemployed\" start_experience_factor = 0.1 start_equipment_factor = 0.5" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Unemployed\" division_template = \"Brodfeld's Unemployed\" start_experience_factor = 0.1 start_equipment_factor = 0.5" 
					owner = ROOT
				}
			}
		}
	}
}

country_event = 
{
	id = brodfeld_rework.2 #focus army the workers
	title = brodfeld_rework.2.t
	desc = brodfeld_rework.2.d
	picture = GFX_event_griffon_mountain
	is_triggered_only = yes
	option = 
	{
		name = brodfeld_rework.2.a
		custom_effect_tooltip = brodfeld_rework.2.b
		hidden_effect = 
		{		
			add_war_support = 0.15
			division_template = 
			{
				name = "Brodfeld's Workers"
				priority = 0
				regiments = 
				{
					infantry = { x = 0 y = 0 }
					infantry = { x = 0 y = 1 }
					infantry = { x = 0 y = 2 }
				}
			}
			508 = 
			{
				#limit = { ROOT = { has_full_control_of_state = PREV } } #to decide wether to limit it and how later
				create_unit = 
				{
					division = "name = \"Brodfeld's Workers\" division_template = \"Brodfeld's Workers\" start_experience_factor = 0.1 start_equipment_factor = 0.3" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Workers\" division_template = \"Brodfeld's Workers\" start_experience_factor = 0.1 start_equipment_factor = 0.3" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Workers\" division_template = \"Brodfeld's Workers\" start_experience_factor = 0.1 start_equipment_factor = 0.3" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Workers\" division_template = \"Brodfeld's Workers\" start_experience_factor = 0.1 start_equipment_factor = 0.3" 
					owner = ROOT
				}
			}
		}
	}
}

country_event = 
{
	id = brodfeld_rework.3 #focus army the workers
	title = brodfeld_rework.3.t
	desc = brodfeld_rework.3.d
	is_triggered_only = yes
	option = 
	{
		name = brodfeld_rework.3.a
		custom_effect_tooltip = brodfeld_rework.3.b
		hidden_effect = 
		{		
			add_war_support = 0.15
			division_template = 
			{
				name = "Brodfeld's Civilians"
				priority = 0
				regiments = 
				{
					infantry = { x = 0 y = 0 }
					infantry = { x = 0 y = 1 }
					infantry = { x = 0 y = 2 }
					infantry = { x = 1 y = 0 }
					infantry = { x = 1 y = 1 }
					infantry = { x = 1 y = 2 }
				}
			}
			508 = 
			{
				#limit = { ROOT = { has_full_control_of_state = PREV } } #to decide wether to limit it and how later
				create_unit = 
				{
					division = "name = \"Brodfeld's Civilians\" division_template = \"Brodfeld's Civilians\" start_experience_factor = 0.0 start_equipment_factor = 0.1" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Civilians\" division_template = \"Brodfeld's Civilians\" start_experience_factor = 0.0 start_equipment_factor = 0.1" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Civilians\" division_template = \"Brodfeld's Civilians\" start_experience_factor = 0.0 start_equipment_factor = 0.1" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Civilians\" division_template = \"Brodfeld's Civilians\" start_experience_factor = 0.0 start_equipment_factor = 0.1" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"Brodfeld's Civilians\" division_template = \"Brodfeld's Civilians\" start_experience_factor = 0.0 start_equipment_factor = 0.1" 
					owner = ROOT
				}
			}
		}
	}
}

country_event = 
{
	id = brodfeld_rework.4 #focus a deep plan #dbg works
	title = brodfeld_rework.4.t
	desc = brodfeld_rework.4.d
	picture = GFX_event_griffon_mountain
	is_triggered_only = yes
	option = 
	{
		name = brodfeld_rework.4.a
		custom_effect_tooltip = brodfeld_rework.4.b
		add_ideas = BRF_deep_plan
		country_event = { id = brodfeld_rework.5 days = 30 }
		
	}
}


country_event = {
    id = brodfeld_rework.5 #deep plan reward 
    title = {
        text = brodfeld_rework.5_t_success
        trigger = { 385 = { is_controlled_by = ROOT } }
    }
    title = {
        text = brodfeld_rework.5_t_fail
        trigger = { NOT = { 385 = { is_controlled_by = ROOT } } }
    }
    desc = {
        text = brodfeld_rework.5_d_success
        trigger = { 385 = { is_controlled_by = ROOT } }
    }
    desc = {
        text = brodfeld_rework.5_d_fail
        trigger = { NOT = { 385 = { is_controlled_by = ROOT } } }
    }
    picture = GFX_event_griffon_mountain
    is_triggered_only = yes
    option = {
        name = brodfeld_rework.5.a
        trigger = {
                385 = { is_controlled_by = ROOT }
				# i.e. has_idea = BRF_deep_plan
            }
            set_technology = 
			{
				infantry_weapons = 1
			}
			add_equipment_to_stockpile = 
			{
				type = infantry_equipment_0 
				amount = 1500 
				producer = WNG 
			}
        }
    option = {
        name = brodfeld_rework.5.b
        trigger = {
                NOT = { 385 = { is_controlled_by = ROOT } }
				#i.e. NOT = { has_idea = BRF_deep_plan}
            }
            #just the text informing that the quest was lost
    }
}
	
country_event = 
{
	id = brodfeld_rework.6 #focus operation violet
	title = brodfeld_rework.6.t
	desc = brodfeld_rework.6.d
	picture = GFX_event_griffon_mountain
	is_triggered_only = yes
	option = 
	{
		name = brodfeld_rework.6.a
		custom_effect_tooltip = brodfeld_rework.6.b
		hidden_effect = 
		{		
			division_template = 
			{
				name = "'Operation Violet' Special Forces"
				priority = 0
				regiments = 
				{
					knights = { x = 0 y = 0 }
					knights = { x = 1 y = 0 }
					knights = { x = 0 y = 1 }
					knights = { x = 1 y = 1 }
					knights = { x = 0 y = 2 }
					knights = { x = 1 y = 2 }
					#maybe add later field hospital, signal company etc
				}
			}
			508 = 
			{
				#limit = { ROOT = { has_full_control_of_state = PREV } } #to decide wether to limit it and how later
				create_unit = 
				{
					division = "name = \"'Operation Violet' Special Forces\" division_template = \"'Operation Violet' Special Forces\" start_experience_factor = 1" 
					owner = ROOT
				}
				create_unit = 
				{
					division = "name = \"'Operation Violet' Special Forces\" division_template = \"'Operation Violet' Special Forces\" start_experience_factor = 1" 
					owner = ROOT
				}
			}
		}
	}
}
	
country_event =  #to do: maybe add all these messagebox events to one big scripted one
{
	id = brodfeld_rework.7 #focus freedom isnt free
	title = brodfeld_rework.7.t
	desc = brodfeld_rework.7.d
	picture = GFX_event_griffon_mountain
	is_triggered_only = yes
	option = 
	{
		name = brodfeld_rework.7.a
		custom_effect_tooltip = brodfeld_rework.7.b		
	}
}

country_event = 
{
	id = brodfeld_rework.8 #focus exile democrats
	title = brodfeld_rework.8.t
	desc = brodfeld_rework.8.d
	picture = GFX_event_griffon_mountain
	is_triggered_only = yes
	option =  
	{
		name = brodfeld_rework.8.a
		custom_effect_tooltip = brodfeld_rework.8.b		
		set_country_flag = BRF_enrico_pardoned
	}
}

country_event = 
{
	id = brodfeld_rework.9 #focus tame red bear
	title = brodfeld_rework.9.t
	desc = brodfeld_rework.9.d
	picture = GFX_event_griffon_mountain
	is_triggered_only = yes
	option =  
	{
		name = brodfeld_rework.9.a
		#custom_effect_tooltip = brodfeld_rework.9.b	
		create_corps_commander = {
			name = "Theresa"
			portrait_path = "gfx/leaders/GRW/Mors.tga"
			traits = { promising_general }
			skill = 2
			attack_skill = 3
			defense_skill = 3
			planning_skill = 2
			logistics_skill = 1
			female = yes
		}		
	}
}

country_event = 
{
	id = brodfeld_rework.10 #focus royal dinner
	title = brodfeld_rework.10.t
	desc = brodfeld_rework.10.d
	picture = GFX_event_griffon_mountain
	is_triggered_only = yes
	option =  
	{
		name = brodfeld_rework.10.a
		custom_effect_tooltip = brodfeld_rework.10.b		
	}
}

country_event = 
{
	id = brodfeld_rework.11 #focus new beginnings
	title = brodfeld_rework.11.t
	desc = brodfeld_rework.11.d
	picture = GFX_event_griffon_mountain
	is_triggered_only = yes
	option =  
	{
		name = brodfeld_rework.11.a
		custom_effect_tooltip = brodfeld_rework.11.b		
	}
}

country_event = 
{
	id = brodfeld_rework.12 #prince meeting event
	title = brodfeld_rework.12.t
	desc = brodfeld_rework.12.d
	picture = GFX_event_griffon_mountain
	fire_only_once =  yes
	trigger =
	{
		 OR =
		 {
			has_completed_focus = BRF_finance_military
			has_completed_focus = BRF_finance_economic 
		 }
	}
	mean_time_to_happen = 
	{
		days = 30
	}
	option =  
	{
		name = brodfeld_rework.12.a
		custom_effect_tooltip = brodfeld_rework.12.b	
		set_country_flag = BRF_king_agree
	}
	option =  
	{
		name = brodfeld_rework.12.c
		custom_effect_tooltip = brodfeld_rework.12.e	
		set_country_flag = BRF_king_disagree
	}
}

country_event = 
{
	id = brodfeld_rework.13 #focus a new leadr, elections
	title = brodfeld_rework.13.t
	desc = brodfeld_rework.13.d
	picture = GFX_event_griffon_mountain
	is_triggered_only = yes  
	option =  
	{
		name = brodfeld_rework.13.a
		custom_effect_tooltip = brodfeld_rework.13.b		
	}
	#option... mason stuff. implement later
}

country_event =  #doesn't work.  Error: "Unexpected token: if, near line: 417...
{
    id = brodfeld_rework.14 #focuses music tempo recovery 
	picture = GFX_event_griffon_mountain
	fire_only_once = yes
	trigger = 
	{
		OR =
		{
			has_completed_focus = BRF_largo_recovery
			has_completed_focus = BRF_adagio_recovery
			has_completed_focus = BRF_allegro_recovery
			has_completed_focus = BRF_presto_recovery
		}
	}	
	if = { limit = { has_completed_focus = BRF_largo_recovery }
			title = brodfeld_rework.14.t.largo
			desc = brodfeld_rework.14.d.largo
			option = 
			{
				name = brodfeld_rework.14.a.largo
				custom_effect_tooltip.14.b.largo
				add_ideas = BRF_recovery_largo
			}
		}
	if = { limit = { has_completed_focus = BRF_adagio_recovery }
			title = brodfeld_rework.14.t.adagio
			desc = brodfeld_rework.14.d.adagio
			option = 
			{
				name = brodfeld_rework.14.a.adagio
				custom_effect_tooltip.14.b.adagio
				add_ideas = BRF_recovery_adagio
			}
		}	
	if = { limit = { has_completed_focus = BRF_allegro_recovery }
			title = brodfeld_rework.14.t.allegro
			desc = brodfeld_rework.14.d.allegro
			option = 
			{
				name = brodfeld_rework.14.a.allegro
				custom_effect_tooltip.14.b.allegro
				add_ideas = BRF_recovery_allegro
			}
		}	
	if = { limit = { has_completed_focus = BRF_presto_recovery }
			title = brodfeld_rework.14.t.presto
			desc = brodfeld_rework.14.d.presto
			option = 
			{
				name = brodfeld_rework.14.a.presto
				custom_effect_tooltip.14.b.presto
				add_ideas = BRF_recovery_presto
			}
		}
}




#end public events

#include in the spawning code:
#NOT = { has_country_flag = BRF_already spawned }
#then, in the part that spawns the troops, right at the end
#set_country_flag = BRF_already_spawned


#option = {
#        name = falcor.1.a
#        custom_effect_tooltip = FLA_form_militias_tt
#        hidden_effect = { load_oob = FAL_Militias }
#    }

#trigger = {
#	AND = {
#		NOT = { has_country_flag = pakistani_question }
#		tag = RAJ
#		GRE = { owns_state = 440 }
#		GRE = { owns_state = 441 }
#		GRE = { owns_state = 442 }
#		GRE = { owns_state = 443 }
#		GRE = { owns_state = 444 }
#		GRE = { owns_state = 445 }
#	}
#}
#
#mean_time_to_happen = {
#	days = 1
#}
#
#option = {
#	ai_chance = {
#		factor = 100
#	}
#	name = persia.10.a
#		GRE = { 
#			country_event = { hours = 6 id = persia.11 }
#		}
#	set_country_flag = pakistani_question
#}

#option = {
#	ai_chance = {
#		factor = 0
#	}
#	name = persia.10.b
#	set_country_flag = pakistani_question
#}
#}
















