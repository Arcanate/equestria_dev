add_namespace = MAN_ELF_new

country_event = {
	id = MAN_ELF_new.300 ## from CHN perspective: MAN post-independence, they fail the love tax too many times and CHN gets angery ##
	immediate = {log = "[GetDateText]: [Root.GetName]: event MAN_ELF_new.300"} 
	title = MAN_ELF_new.300.t
	desc = MAN_ELF_new.300.d
	
	picture = GFX_event_changeling_approved_stamp
	fire_only_once = yes
	trigger = {
		original_tag = CHN ## from CHN perspective ##
		MAN = {
			is_subject = no
			is_faction_leader = no
			has_country_flag = MAN_has_become_de_jure_puppet
			check_variable = { MAN_variable_for_post_independence_love_tax_failure_consequences > 2 }
		}
	}
	option = {
		name = MAN_ELF_new.300.a
		MAN = { country_event = { id = MAN_ELF_new.301 hours = 3 } }
		CHN = { add_opinion_modifier = { target = MAN modifier = CHN_disapproves_actions } }
	}
}

country_event = {
	id = MAN_ELF_new.301 ## from MAN's perspective: your first and last warning from CHN ##
	immediate = {log = "[GetDateText]: [Root.GetName]: event MAN_ELF_new.301"} 
	title = MAN_ELF_new.301.t
	desc = MAN_ELF_new.301.d
	
	picture = GFX_event_changeling_approved_stamp
	is_triggered_only = yes
	option = {
		name = MAN_ELF_new.301.a
		add_political_power = -20
		effect_tooltip = {
			CHN = { add_opinion_modifier = { target = MAN modifier = CHN_disapproves_actions } }
		}
		set_country_flag = MAN_has_received_warning_from_CHN_for_failing_love_tax
	}
}

country_event = {
	id = MAN_ELF_new.302 ## from CHN's perspective: they failed the love tax again, Chrysalis is pissed ##
	immediate = {log = "[GetDateText]: [Root.GetName]: event MAN_ELF_new.302"} 
	title = MAN_ELF_new.302.t
	desc = MAN_ELF_new.302.d
	
	picture = GFX_event_changeling_approved_stamp
	fire_only_once = yes
	trigger = {
		original_tag = CHN
		MAN = {
			is_subject = no
			is_faction_leader = no
			has_country_flag = MAN_has_received_warning_from_CHN_for_failing_love_tax
			has_country_flag = MAN_has_become_de_jure_puppet
			check_variable = { MAN_variable_for_post_independence_love_tax_failure_consequences > 4 }
		}
	}
	option = { ## let this slide ##
		name = MAN_ELF_new.302.a
		add_political_power = -30
		CHN = { add_opinion_modifier = { target = MAN modifier = MAN_distrust } }
	}
	option = { ## we're coming for you Lysia you filthy traitor ##
		name = MAN_ELF_new.302.b
		MAN = { country_event = { id = MAN_ELF_new.303 hours = 3 } }
		CHN = { add_opinion_modifier = { target = MAN modifier = hostility } }
		CHN = {
			create_wargoal = {
				type = puppet_wargoal_focus
				target = MAN
			} 
		}
	}
}

country_event = {
	id = MAN_ELF_new.303 ## o shit they werent bluffing oh no oh no ##
	immediate = {log = "[GetDateText]: [Root.GetName]: event MAN_ELF_new.303"} 
	title = MAN_ELF_new.303.t
	desc = MAN_ELF_new.303.d
	
	picture = GFX_event_changeling_approved_stamp
	is_triggered_only = yes
	option = {
		name = MAN_ELF_new.303.a
		add_political_power = -50
		add_stability = -0.05
	}
}

country_event = { ## removal of cosmetic tag upon independence, but stays the Manehattan Protectorate and is de jure a puppet ##
	id = MAN_ELF_new.500
	immediate = {log = "[GetDateText]: [Root.GetName]: event MAN_ELF_new.500"}
	title = MAN_ELF_new.500.t
	desc = MAN_ELF_new.500.d
	picture = GFX_event_crystaller_building

	trigger = {
		original_tag = MAN
		has_country_flag = is_changeling_puppet
		is_subject = no
	}
	
	fire_only_once = yes
	mean_time_to_happen = { days = 1 }
	
	option = {
		name = MAN_ELF_new.500.a
		add_political_power = 50
		drop_cosmetic_tag = yes
		set_cosmetic_tag = MAN_CHN_autonomous
		hidden_effect = {
			CHN = { puppet = MAN }
			CHN = {
				set_autonomy = {
					target = MAN
					autonomy_state = autonomy_de_jure_puppet
				}
			}
		}
		set_country_flag = MAN_has_become_de_jure_puppet
	}
}

country_event = { ## removal of the advisor keneath ##
	id = MAN_ELF_new.501
	immediate = {log = "[GetDateText]: [Root.GetName]: event MAN_ELF_new.501"}
	title = MAN_ELF_new.501.t
	desc = MAN_ELF_new.501.d
	picture = GFX_event_crystaller_building

	trigger = {
		original_tag = MAN
		is_subject = yes
		has_country_flag = is_changeling_puppet
		NOT = { has_country_flag = MAN_has_become_de_jure_puppet }
		NOT = { 
			has_idea = MAN_advisor_2
			has_country_flag = MAN_events_501_or_502_fired_already 
			has_country_flag = MAN_removed_keneath_in_event_46
		}
	}
	
	fire_only_once = yes
	mean_time_to_happen = { days = 1 }
	
	option = {
		name = MAN_ELF_new.501.a
		set_country_flag = MAN_events_501_or_502_fired_already
		add_political_power = -50
		custom_effect_tooltip = MAN_autonomy_score_minus_300
		hidden_effect = {
			add_autonomy_score = {
				value = -300 
				localization = MAN_angered_chrysalis
			}
		}
	}
}

country_event = { ## removal of the advisor keneath, but CHN can't do anything about it ##
	id = MAN_ELF_new.502
	immediate = {log = "[GetDateText]: [Root.GetName]: event MAN_ELF_new.502"}
	title = MAN_ELF_new.502.t
	desc = MAN_ELF_new.502.d
	picture = GFX_event_crystaller_building

	trigger = {
		original_tag = MAN
		is_subject = yes
		has_country_flag = is_changeling_puppet
		has_country_flag = MAN_has_become_de_jure_puppet
		NOT = { 
			has_idea = MAN_advisor_2
			has_country_flag = MAN_events_501_or_502_fired_already 
			has_country_flag = MAN_removed_keneath_in_event_46
		}
	}
	
	fire_only_once = yes
	mean_time_to_happen = { days = 1 }
	
	option = {
		name = MAN_ELF_new.502.a
		set_country_flag = MAN_events_501_or_502_fired_already
		add_political_power = -20
	}
}

country_event = {
	id = MAN_ELF_new.331 ## report to lysia warning her if MAN loses any more core states to pony uprisings, then the ELF will surely rise up due to the changeling's weak grip on their own territories; mention how the states where MAN has lost their cores have essentially become no-go areas except for heavily armed patrols ##
	immediate = {log = "[GetDateText]: [Root.GetName]: event MAN_ELF_new.331"} 
	title = MAN_ELF_new.331.t
	desc = MAN_ELF_new.331.d
	
	picture = GFX_event_changeling_approved_stamp
	is_triggered_only = yes
	option = {
		name = MAN_ELF_new.331.a
		custom_effect_tooltip = MAN_lost_too_many_core_states_warning_tt
		set_country_flag = MAN_this_is_your_final_warning_dont_lose_any_more_states
	}
}

country_event = {
	id = MAN_ELF_new.139 ## from Chrysalis's Perspective: Lysia sends a very polite letter citing the numerous (strategic, economic, administrative) reasons why the vast territories of the equestrian midlands should be detached from direct rule from Vesalipolis and transferred to the nascent Republic of eastern equestria instead. also, such an expansion will strengthen ostEquestrian sense of national identity ##
	immediate = {
		log = "[GetDateText]: [Root.GetName]: event MAN_ELF_new.139"
		set_temp_variable = { MAN_CHN_division_number_comparison_temp_midlands = CHN.num_divisions }
		divide_temp_variable = { MAN_CHN_division_number_comparison_temp_midlands = 5 }
		multiply_variable = { MAN_CHN_division_number_comparison_temp_midlands = 3 } ### three-fifths #####
		set_variable = { MAN_CHN_division_number_comparison_proper_midlands = MAN_CHN_division_number_comparison_temp_midlands }
	}
	title = MAN_ELF_new.139.t 
	desc = MAN_ELF_new.139.d 
	picture = GFX_event_changeling_approved_stamp
	is_triggered_only = yes
	
	option = {
		name = MAN_ELF_new.139.a ## yes ##
		ai_chance = { 
			factor = 50
			modifier = {
				add = 999
				check_variable = { MAN.num_divisions > MAN_CHN_division_number_comparison_proper }
			}
		}
		MAN = { country_event = { id = MAN_ELF_new.140 hours = 3 } }
	}
	
	option = {
		name = MAN_ELF_new.139.b ## no ##
		ai_chance = { 
			factor = 50
			modifier = {	
				add = 999
				check_variable = { MAN.num_divisions < MAN_CHN_division_number_comparison_proper }
			}
		}
		MAN = { country_event = { id = MAN_ELF_new.141 hours = 3 } }
	}
}

country_event = {
	id = MAN_ELF_new.140 ## proposal accepted, now the Republic of Eastern Equestria rules the Midlands ##
	immediate = {log = "[GetDateText]: [Root.GetName]: event MAN_ELF_new.140"}
	title = MAN_ELF_new.140.t 
	desc = MAN_ELF_new.140.d 
	picture = GFX_event_changeling_approved_stamp
	is_triggered_only = yes
	
	option = { 
		name = MAN_ELF_new.140.a
		add_political_power = 30
		transfer_state = 70
		add_state_core = 70
		transfer_state = 74
		add_state_core = 74
		if = { 
			limit = { CHN = { OR = { controls_state = 178 owns_state = 178 } } }
			add_state_core = 178
			transfer_state = 178
		}
		if = { 
			limit = { CHN = { OR = { controls_state = 182 owns_state = 182 } } }
			add_state_core = 182
			transfer_state = 182
		}
		if = { 
			limit = { CHN = { OR = { controls_state = 176 owns_state = 176 } } }
			add_state_core = 176
			transfer_state = 176
		}
		if = { 
			limit = { CHN = { OR = { controls_state = 177 owns_state = 177 } } }
			add_state_core = 177
			transfer_state = 177
		}
		if = { 
			limit = { CHN = { OR = { controls_state = 134 owns_state = 134 } } }
			add_state_core = 134
			transfer_state = 134
		}
		if = { 
			limit = { CHN = { OR = { controls_state = 135 owns_state = 135 } } }
			add_state_core = 135
			transfer_state = 135
		}
		if = { 
			limit = { CHN = { OR = { controls_state = 56 owns_state = 56 } } }
			add_state_core = 56
			transfer_state = 56
		}
		if = { 
			limit = { CHN = { OR = { controls_state = 183 owns_state = 183 } } }
			add_state_core = 183
			transfer_state = 183
		}
		if = { 
			limit = { CHN = { OR = { controls_state = 102 owns_state = 102 } } }
			add_state_core = 102
			transfer_state = 102
		}
		if = { 
			limit = { CHN = { OR = { controls_state = 154 owns_state = 154 } } }
			add_state_core = 154
			transfer_state = 154
		}
		if = { 
			limit = { CHN = { OR = { controls_state = 155 owns_state = 155 } } }
			add_state_core = 155
			transfer_state = 155
		}
		if = { 
			limit = { CHN = { OR = { controls_state = 156 owns_state = 156 } } }
			add_state_core = 156
			transfer_state = 156
		}
		if = { 
			limit = { CHN = { OR = { controls_state = 157 owns_state = 157 } } }
			add_state_core = 157
			transfer_state = 157
		}
		if = { 
			limit = { CHN = { OR = { controls_state = 326 owns_state = 326 } } }
			add_state_core = 326
			transfer_state = 326
		}
		if = { 
			limit = { CHN = { OR = { controls_state = 160 owns_state = 160 } } }
			add_state_core = 160
			transfer_state = 160
		}
		if = { 
			limit = { CHN = { OR = { controls_state = 162 owns_state = 162 } } }
			add_state_core = 162
			transfer_state = 162
		}
		if = { 
			limit = { CHN = { OR = { controls_state = 164 owns_state = 164 } } }
			add_state_core = 164
			transfer_state = 164
		}
	}
}

country_event = {
	id = MAN_ELF_new.141 ## Lysia's gambit refused ##
	immediate = {log = "[GetDateText]: [Root.GetName]: event MAN_ELF_new.141"}
	title = MAN_ELF_new.141.t 
	desc = MAN_ELF_new.141.d 
	picture = GFX_event_changeling_approved_stamp
	is_triggered_only = yes
	
	option = {
		name = MAN_ELF_new.141.a
		add_political_power = -70
	}
}

country_event = {
	id = MAN_ELF_new.142 ### finally we can breathe -- racous celebrations in the ELF-held territories as ponies celebrate their freedom, but the festivities are tinged by a sense of grimness because everypony will have to participate in the war effort. but the mood is optimistic and everypony commits themselves to the great struggle against the changelings. after the parties a lot of ponies go and enroll themselves into their local militias. startrix gives an inspirational speech over the radio calling on all ponies to fight for their freedom and for each other ###
	immediate = {log = "[GetDateText]: [Root.GetName]: event MAN_ELF_new.142"}
	title = MAN_ELF_new.142.t 
	desc = MAN_ELF_new.142.d 
	picture = GFX_event_ponies_cheering
	is_triggered_only = yes
	
	option = {
		name = MAN_ELF_new.142.a
		add_political_power = 70
		add_stability = 0.03
		add_manpower = 32000
	}
}

country_event = {
	id = MAN_ELF_new.143 ### introduction to the ELF -- a wildly diverse mass movement comprising activists and ideologues from all across the political spectrum, from Stalliongrad to the riverlands and even batponies, hippogriffs and griffons, all united in the dream of a free equestria. led by the visionary duo starlight and trixie, the dummvirate, said to be the successors to the fallen diarchy. a lot of ponies bled and died killed by the changelings ruthless desire to keep control their blood tears and sweat forming the glue that holds the ELF together. this is the final struggle the eleventh hour of the equestrian nation to free themselves. revanchism in the ranks as ponies plot to revenge themselves on their oppressors and the collaborationists. rebirth, rising from the ashes, the sun moon and swords ##
	immediate = {log = "[GetDateText]: [Root.GetName]: event MAN_ELF_new.143"}
	title = MAN_ELF_new.143.t 
	desc = MAN_ELF_new.143.d 
	picture = GFX_event_ponies_crowd
	is_triggered_only = yes
	
	option = {
		name = MAN_ELF_new.143.a
		add_war_support = 0.10
		custom_effect_tooltip = ELF_good_luck_ponies_tt
	}
}

country_event = {
	id = MAN_ELF_new.144 ## startrixie appeals to the assembly of the everfree coalition at the capitol (use [Root.Capital.GetName]) for unity all across the spectrum, and to place all their individual milita units under the centralised ELF command. their speech is followed by supporting arguments from representatives from the equestrian all-union communist party and other political factions. ##
	immediate = {log = "[GetDateText]: [Root.GetName]: event MAN_ELF_new.144"}
	title = MAN_ELF_new.144.t 
	desc = MAN_ELF_new.144.d 
	picture = GFX_event_ponies_cheering
	is_triggered_only = yes
	
	option = {
		name = MAN_ELF_new.144.a
		add_command_power = 50
		custom_effect_tooltip = ELF_the_combined_units_deploy
		hidden_effect = {
			division_template = {
				name = "Coalition Combined Brigade"
				division_names_group = EQS_INF_01
				regiments = {
					infantry = { x = 0 y = 0 }
					infantry = { x = 0 y = 1 }
					infantry = { x = 0 y = 2 }
					infantry = { x = 0 y = 3 }
				}
				support = {
					engineer = { x = 0 y = 0 }
					artillery = { x = 0 y = 1 }
				}
			}
			random_owned_controlled_state = {
				limit = { is_capital = yes }
				create_unit = { division = "name = \"'Bellerophon' Brigade\" division_template = \"Coalition Combined Brigade\" start_experience_factor = 0.55" 
				owner = ELF }
				create_unit = { division = "name = \"'Red Devils' Brigade\" division_template = \"Coalition Combined Brigade\" start_experience_factor = 0.55" 
				owner = ELF }
				create_unit = { division = "name = \"'Restless Spirits' Brigade\" division_template = \"Coalition Combined Brigade\" start_experience_factor = 0.55" 
				owner = ELF }
				create_unit = { division = "name = \"'Revolutionary Nuclei' Brigade\" division_template = \"Coalition Combined Brigade\" start_experience_factor = 0.55" 
				owner = ELF }
				create_unit = { division = "name = \"'Equestrian Patriots' Brigade\" division_template = \"Coalition Combined Brigade\" start_experience_factor = 0.55" 
				owner = ELF }
				create_unit = { division = "name = \"'Militant Tendency' Brigade\" division_template = \"Coalition Combined Brigade\" start_experience_factor = 0.55" 
				owner = ELF }
				create_unit = { division = "name = \"'Horn and Wings' Brigade\" division_template = \"Coalition Combined Brigade\" start_experience_factor = 0.55" 
				owner = ELF }
				create_unit = { division = "name = \"The Angry Brigade\" division_template = \"Coalition Combined Brigade\" start_experience_factor = 0.55" 
				owner = ELF }
			}
		}
	}
}